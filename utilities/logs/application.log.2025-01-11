2025-01-11 11:47:27,520 - app_logger - INFO - Shutting down the application...
2025-01-11 11:47:28,395 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-11 11:47:28,395 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-11 11:47:28,395 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-11 11:47:28,395 - app_logger - INFO - Starting the application...
2025-01-11 11:47:28,737 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-11 11:47:28,738 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 11:47:28,738 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-11 11:47:29,122 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 11:47:30,191 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 11:47:30,207 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-11 11:47:30,829 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-11 11:47:30,831 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-11 11:47:30,832 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-11 11:47:30,832 - app_logger - INFO - Starting the application...
2025-01-11 11:47:31,170 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-11 11:47:31,170 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 11:47:31,171 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-11 11:47:31,998 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-11 11:47:31,998 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-11 11:47:31,998 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-11 11:47:31,998 - app_logger - INFO - Starting the application...
2025-01-11 11:47:32,389 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-11 11:47:32,389 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 11:47:32,389 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-11 11:47:32,674 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 11:47:33,366 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 11:47:33,378 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-11 11:47:33,834 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 11:47:34,539 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 11:47:34,539 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 11:47:34,539 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-11 11:47:35,321 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-11 11:47:35,624 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 11:47:35,625 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-11 11:47:35,626 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-11 11:47:35,626 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 11:47:35,627 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-11 11:47:35,673 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 11:47:35,673 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 11:47:35,673 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-11 11:47:35,673 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 11:47:35,673 - app_logger - INFO - Monday Service initialized
2025-01-11 11:47:35,673 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-11 11:47:35,674 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 11:47:35,674 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 11:47:35,674 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-11 11:47:35,675 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 11:47:35,675 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-11 11:47:35,727 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 11:47:35,727 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 11:47:35,732 - app_logger - INFO - OCR Service initialized
2025-01-11 11:47:35,732 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-11 11:47:35,732 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 11:47:35,732 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 11:47:35,734 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 11:47:35,734 - app_logger - DEBUG - Initialized XeroServices.
2025-01-11 11:47:35,734 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-11 11:47:35,814 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 11:47:35,814 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 11:47:35,814 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 11:47:35,814 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 11:47:35,814 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 11:47:35,814 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 11:47:35,815 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-11 11:47:35,815 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 11:47:35,815 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-11 11:47:35,816 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 11:47:35,822 - app_logger - INFO - ‚úÖ All table triggers have been registered successfully!
2025-01-11 11:47:35,849 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-11 11:47:35,849 - app_logger - INFO - Database initialized.
2025-01-11 11:47:35,849 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 11:47:35,849 - app_logger - INFO - Orchestrator initialized.
2025-01-11 11:47:35,849 - app_logger - INFO - Starting background tasks...
2025-01-11 11:47:35,850 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 11:47:35,914 - app_logger - INFO - Flask server running on port 5002.
2025-01-11 11:47:54,768 - app_logger - INFO - Received Dropbox event.
2025-01-11 11:47:54,768 - app_logger - INFO - Starting to process event data...
2025-01-11 11:47:54,770 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 11:47:54,937 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 11:47:54,938 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 11:47:54,938 - app_logger - INFO - Changes (1):
2025-01-11 11:47:54,939 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:47:54,939 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:47:54,939 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:47:54,939 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:47:54,939 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:47:55,528 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 11:47:56,513 - app_logger - DEBUG - ü§î Checking for PurchaseOrders with (project_number='2416', po_number='21').
2025-01-11 11:47:56,513 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 11:47:56,553 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 11:47:56,553 - app_logger - DEBUG - ü§ì Pulling record: 1448 from table purchase_order
2025-01-11 11:47:56,554 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 11:47:56,554 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 11:47:56,558 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 11:47:56,558 - app_logger - DEBUG - ü§ì Pulling record: 87 from table invoice
2025-01-11 11:47:56,559 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 11:47:56,559 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=87), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 11:47:56,559 - app_logger - DEBUG - üîß Attempting to update Invoice(id=87). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 11:47:56,559 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 11:47:56,562 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=87) updated.
2025-01-11 11:47:56,692 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-11 11:47:56,692 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 11:47:56,692 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-11 11:47:56,692 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 11:47:56,692 - app_logger - DEBUG - Initialized DatabaseTriggerService singleton.
2025-01-11 11:47:56,692 - app_logger - DEBUG - Created a new instance of DatabaseTriggerService.
2025-01-11 11:47:56,759 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 11:47:56,762 - app_logger - DEBUG - ü§ì Pulling record: 87 from table invoice
2025-01-11 11:47:57,419 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 11:47:58,291 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 11:47:58,292 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 11:47:58,292 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=87), data={'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 11:47:58,292 - app_logger - DEBUG - üîß Attempting to update Invoice(id=87). Fields: {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 11:47:58,292 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 11:47:58,295 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=87) updated.
2025-01-11 11:47:58,299 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 11:47:58,301 - app_logger - DEBUG - ü§ì Pulling record: 87 from table invoice
2025-01-11 11:47:58,302 - app_logger - DEBUG - üîé search_detail_items: columns=['po_id', 'detail_number', 'payment_type'], values=[1448, 1, 'INV']
2025-01-11 11:47:58,302 - app_logger - DEBUG - üïµÔ∏è Searching DetailItem with filters: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 11:47:58,302 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 11:47:58,312 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 11:47:58,312 - app_logger - DEBUG - ü§ì Pulling record: 6222 from table detail_item
2025-01-11 11:47:58,312 - app_logger - DEBUG - ü§ì Pulling record: 6223 from table detail_item
2025-01-11 11:47:58,314 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:47:58,314 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 11:47:58,327 - app_logger - INFO - Received Dropbox event.
2025-01-11 11:47:58,328 - app_logger - INFO - Starting to process event data...
2025-01-11 11:47:58,328 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 11:47:58,476 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 11:47:58,477 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 11:47:58,477 - app_logger - INFO - Changes (0):
2025-01-11 11:47:58,477 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 11:50:12,475 - app_logger - INFO - Received Dropbox event.
2025-01-11 11:50:12,475 - app_logger - INFO - Starting to process event data...
2025-01-11 11:50:12,476 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 11:50:12,949 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 11:50:12,951 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 11:50:12,951 - app_logger - INFO - Changes (1):
2025-01-11 11:50:12,951 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:50:12,951 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:50:12,951 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:50:12,951 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:50:12,952 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:50:13,412 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 11:50:14,336 - app_logger - DEBUG - ü§î Checking for PurchaseOrders with (project_number='2416', po_number='21').
2025-01-11 11:50:14,336 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 11:50:14,339 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 11:50:14,339 - app_logger - DEBUG - ü§ì Pulling record: 1448 from table purchase_order
2025-01-11 11:50:14,339 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 11:50:14,340 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 11:50:14,341 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 11:50:14,341 - app_logger - DEBUG - ü§ì Pulling record: 87 from table invoice
2025-01-11 11:50:14,342 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 11:50:14,342 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=87), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 11:50:14,342 - app_logger - DEBUG - üîß Attempting to update Invoice(id=87). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 11:50:14,342 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 11:50:14,344 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=87) updated.
2025-01-11 11:50:14,346 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 11:50:14,347 - app_logger - DEBUG - ü§ì Pulling record: 87 from table invoice
2025-01-11 11:50:15,523 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 11:50:16,462 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 11:50:16,463 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 11:50:16,463 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=87), data={'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 11:50:16,463 - app_logger - DEBUG - üîß Attempting to update Invoice(id=87). Fields: {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 11:50:16,463 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 11:50:16,466 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=87) updated.
2025-01-11 11:50:16,468 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 11:50:16,470 - app_logger - DEBUG - ü§ì Pulling record: 87 from table invoice
2025-01-11 11:50:16,471 - app_logger - DEBUG - üîé search_detail_items: columns=['po_id', 'detail_number', 'payment_type'], values=[1448, 1, 'INV']
2025-01-11 11:50:16,471 - app_logger - DEBUG - üïµÔ∏è Searching DetailItem with filters: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 11:50:16,471 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 11:50:16,474 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 11:50:16,474 - app_logger - DEBUG - ü§ì Pulling record: 6222 from table detail_item
2025-01-11 11:50:16,474 - app_logger - DEBUG - ü§ì Pulling record: 6223 from table detail_item
2025-01-11 11:50:16,474 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:50:16,475 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 11:50:16,486 - app_logger - INFO - Received Dropbox event.
2025-01-11 11:50:16,486 - app_logger - INFO - Starting to process event data...
2025-01-11 11:50:16,486 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 11:50:16,664 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 11:50:16,665 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 11:50:16,665 - app_logger - INFO - Changes (0):
2025-01-11 11:50:16,666 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 11:53:16,360 - app_logger - INFO - Received Dropbox event.
2025-01-11 11:53:16,361 - app_logger - INFO - Starting to process event data...
2025-01-11 11:53:16,362 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 11:53:16,665 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 11:53:16,665 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 11:53:16,665 - app_logger - INFO - Changes (1):
2025-01-11 11:53:16,666 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:53:16,666 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:53:16,666 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:53:16,666 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:53:16,666 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:53:17,266 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 11:53:18,206 - app_logger - DEBUG - ü§î Checking for PurchaseOrders with (project_number='2416', po_number='21').
2025-01-11 11:53:18,206 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 11:53:18,209 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 11:53:18,209 - app_logger - DEBUG - ü§ì Pulling record: 1448 from table purchase_order
2025-01-11 11:53:18,210 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 11:53:18,210 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 11:53:18,211 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 11:53:18,211 - app_logger - DEBUG - ü§ì Pulling record: 87 from table invoice
2025-01-11 11:53:18,212 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 11:53:18,212 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=87), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 11:53:18,212 - app_logger - DEBUG - üîß Attempting to update Invoice(id=87). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 11:53:18,212 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 11:53:18,214 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=87) updated.
2025-01-11 11:53:18,216 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 11:53:18,217 - app_logger - DEBUG - ü§ì Pulling record: 87 from table invoice
2025-01-11 11:53:18,812 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 11:53:19,842 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 11:53:19,842 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 11:53:19,842 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=87), data={'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 11:53:19,843 - app_logger - DEBUG - üîß Attempting to update Invoice(id=87). Fields: {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 11:53:19,843 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 11:53:19,848 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=87) updated.
2025-01-11 11:53:19,852 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 11:53:19,854 - app_logger - DEBUG - ü§ì Pulling record: 87 from table invoice
2025-01-11 11:53:19,855 - app_logger - DEBUG - üîé search_detail_items: columns=['po_id', 'detail_number', 'payment_type'], values=[1448, 1, 'INV']
2025-01-11 11:53:19,856 - app_logger - DEBUG - üïµÔ∏è Searching DetailItem with filters: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 11:53:19,856 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 11:53:19,859 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 11:53:19,860 - app_logger - DEBUG - ü§ì Pulling record: 6222 from table detail_item
2025-01-11 11:53:19,860 - app_logger - DEBUG - ü§ì Pulling record: 6223 from table detail_item
2025-01-11 11:53:19,861 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 11:53:19,861 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 11:53:19,874 - app_logger - INFO - Received Dropbox event.
2025-01-11 11:53:19,874 - app_logger - INFO - Starting to process event data...
2025-01-11 11:53:19,874 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 11:53:20,026 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 11:53:20,027 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 11:53:20,027 - app_logger - INFO - Changes (0):
2025-01-11 11:53:20,028 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 13:09:35,819 - app_logger - INFO - Shutting down the application...
2025-01-11 13:51:45,317 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-11 13:51:45,317 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-11 13:51:45,317 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-11 13:51:45,317 - app_logger - INFO - Starting the application...
2025-01-11 13:51:45,609 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-11 13:51:45,609 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 13:51:45,609 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-11 13:51:45,882 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 13:51:46,663 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 13:51:46,681 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-11 13:51:47,124 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 13:51:47,764 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 13:51:47,764 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 13:51:47,764 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-11 13:51:48,356 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-11 13:51:48,636 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 13:51:48,636 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-11 13:51:48,637 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-11 13:51:48,637 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 13:51:48,637 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-11 13:51:48,674 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 13:51:48,674 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 13:51:48,674 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-11 13:51:48,675 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 13:51:48,675 - app_logger - INFO - Monday Service initialized
2025-01-11 13:51:48,675 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-11 13:51:48,676 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 13:51:48,676 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 13:51:48,676 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-11 13:51:48,678 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 13:51:48,678 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-11 13:51:48,732 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 13:51:48,732 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 13:51:48,737 - app_logger - INFO - OCR Service initialized
2025-01-11 13:51:48,737 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-11 13:51:48,737 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 13:51:48,737 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 13:51:48,739 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 13:51:48,739 - app_logger - DEBUG - Initialized XeroServices.
2025-01-11 13:51:48,739 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-11 13:51:48,827 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 13:51:48,827 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 13:51:48,827 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 13:51:48,827 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 13:51:48,827 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 13:51:48,828 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 13:51:48,829 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-11 13:51:48,830 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 13:51:48,830 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-11 13:51:48,832 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 13:51:48,838 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 13:51:48,867 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-11 13:51:48,867 - app_logger - INFO - Database initialized.
2025-01-11 13:51:48,867 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 13:51:48,867 - app_logger - INFO - Orchestrator initialized.
2025-01-11 13:51:48,867 - app_logger - INFO - Starting background tasks...
2025-01-11 13:51:48,868 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 13:51:59,397 - app_logger - INFO - Received Dropbox event.
2025-01-11 13:51:59,398 - app_logger - INFO - Starting to process event data...
2025-01-11 13:51:59,399 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 13:51:59,616 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 13:51:59,621 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 13:51:59,623 - app_logger - INFO - Changes (1):
2025-01-11 13:51:59,623 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 13:51:59,624 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 13:51:59,624 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 13:51:59,624 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 13:51:59,624 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 13:52:00,070 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 13:52:01,059 - app_logger - DEBUG - ü§î Checking for PurchaseOrders with (project_number='2416', po_number='21').
2025-01-11 13:52:01,061 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 13:52:01,068 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 13:52:01,070 - app_logger - DEBUG - ü§ì Pulling record: 1448 from table purchase_order
2025-01-11 13:52:01,073 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 13:52:01,074 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 13:52:01,084 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 13:52:01,085 - app_logger - DEBUG - ü§ì Pulling record: 87 from table invoice
2025-01-11 13:52:01,089 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 13:52:01,089 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=87), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 13:52:01,090 - app_logger - DEBUG - üîß Attempting to update Invoice(id=87). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 13:52:01,090 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 13:52:01,100 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=87) updated.
2025-01-11 13:52:01,109 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 13:52:01,111 - app_logger - DEBUG - ü§ì Pulling record: 87 from table invoice
2025-01-11 13:52:01,727 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 13:52:02,565 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 13:52:02,566 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 13:52:02,566 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=87), data={'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 13:52:02,567 - app_logger - DEBUG - üîß Attempting to update Invoice(id=87). Fields: {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 13:52:02,567 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 13:52:02,575 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=87) updated.
2025-01-11 13:52:02,591 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 13:52:02,596 - app_logger - DEBUG - ü§ì Pulling record: 87 from table invoice
2025-01-11 13:52:02,598 - app_logger - DEBUG - üîé search_detail_items: columns=['po_id', 'detail_number', 'payment_type'], values=[1448, 1, 'INV']
2025-01-11 13:52:02,598 - app_logger - DEBUG - üïµÔ∏è Searching DetailItem with filters: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 13:52:02,598 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 13:52:02,601 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 13:52:02,602 - app_logger - DEBUG - ü§ì Pulling record: 6222 from table detail_item
2025-01-11 13:52:02,602 - app_logger - DEBUG - ü§ì Pulling record: 6223 from table detail_item
2025-01-11 13:52:02,603 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 13:52:02,605 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 13:52:02,617 - app_logger - INFO - Received Dropbox event.
2025-01-11 13:52:02,617 - app_logger - INFO - Starting to process event data...
2025-01-11 13:52:02,617 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 13:52:02,774 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 13:52:02,774 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 13:52:02,774 - app_logger - INFO - Changes (0):
2025-01-11 13:52:02,775 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 13:56:08,517 - app_logger - INFO - Shutting down the application...
2025-01-11 13:56:08,963 - app_logger - INFO - Starting the application...
2025-01-11 13:56:09,140 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 13:56:09,331 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 13:56:10,476 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 13:56:11,267 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 13:56:12,051 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 13:56:12,051 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 13:56:12,078 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 13:56:12,078 - app_logger - INFO - Monday Service initialized
2025-01-11 13:56:12,078 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 13:56:12,079 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 13:56:12,108 - app_logger - INFO - OCR Service initialized
2025-01-11 13:56:12,108 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 13:56:12,169 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 13:56:12,169 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 13:56:12,170 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 13:56:12,172 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 13:56:12,186 - app_logger - INFO - Database initialized.
2025-01-11 13:56:12,187 - app_logger - INFO - Orchestrator initialized.
2025-01-11 13:56:12,187 - app_logger - INFO - Starting background tasks...
2025-01-11 13:56:12,187 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 13:56:12,188 - app_logger - INFO - Shutting down the application...
2025-01-11 13:56:12,718 - app_logger - INFO - Starting the application...
2025-01-11 13:56:12,995 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 13:56:13,287 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 13:56:14,325 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 13:56:15,023 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 13:56:15,814 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 13:56:15,815 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 13:56:15,861 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 13:56:15,861 - app_logger - INFO - Monday Service initialized
2025-01-11 13:56:15,862 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 13:56:15,862 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 13:56:15,906 - app_logger - INFO - OCR Service initialized
2025-01-11 13:56:15,906 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 13:56:15,968 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 13:56:15,968 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 13:56:15,968 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 13:56:15,975 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 13:56:16,000 - app_logger - INFO - Database initialized.
2025-01-11 13:56:16,000 - app_logger - INFO - Orchestrator initialized.
2025-01-11 13:56:16,000 - app_logger - INFO - Starting background tasks...
2025-01-11 13:56:16,000 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 14:03:02,354 - app_logger - INFO - Shutting down the application...
2025-01-11 14:03:02,989 - app_logger - INFO - Starting the application...
2025-01-11 14:03:03,321 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 14:03:03,650 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 14:03:06,117 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 14:03:07,513 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 14:03:08,230 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 14:03:08,231 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 14:03:08,285 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 14:03:08,286 - app_logger - INFO - Monday Service initialized
2025-01-11 14:03:08,286 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 14:03:08,287 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 14:03:08,333 - app_logger - INFO - OCR Service initialized
2025-01-11 14:03:08,333 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 14:03:08,394 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 14:03:08,395 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 14:03:08,395 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 14:03:08,402 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 14:03:08,427 - app_logger - INFO - Database initialized.
2025-01-11 14:03:08,427 - app_logger - INFO - Orchestrator initialized.
2025-01-11 14:03:08,427 - app_logger - INFO - Starting background tasks...
2025-01-11 14:03:08,428 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 14:03:08,468 - app_logger - INFO - Flask server running on port 5002.
2025-01-11 14:03:41,132 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:03:41,132 - app_logger - INFO - Starting to process event data...
2025-01-11 14:03:41,332 - app_logger - INFO - Changes (1):
2025-01-11 14:03:41,335 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:03:41,335 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:03:41,337 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:03:41,338 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:03:41,340 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:03:41,828 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 14:03:42,911 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 14:03:42,947 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 14:03:42,952 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 14:03:42,960 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 14:03:42,961 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 14:03:42,961 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 14:03:43,174 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:03:44,545 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 14:03:44,546 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 14:03:44,550 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:03:44,556 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 14:03:44,563 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 14:03:44,563 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:03:44,576 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:03:44,576 - app_logger - INFO - Starting to process event data...
2025-01-11 14:03:44,718 - app_logger - INFO - Changes (0):
2025-01-11 14:09:08,044 - app_logger - INFO - Shutting down the application...
2025-01-11 14:09:08,564 - app_logger - INFO - Starting the application...
2025-01-11 14:09:08,855 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 14:09:09,189 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 14:09:11,733 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 14:09:14,462 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 14:09:15,309 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 14:09:15,311 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 14:09:15,364 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 14:09:15,364 - app_logger - INFO - Monday Service initialized
2025-01-11 14:09:15,365 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 14:09:15,365 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 14:09:15,412 - app_logger - INFO - OCR Service initialized
2025-01-11 14:09:15,412 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 14:09:15,474 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 14:09:15,475 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 14:09:15,475 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 14:09:15,482 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 14:09:15,507 - app_logger - INFO - Database initialized.
2025-01-11 14:09:15,507 - app_logger - INFO - Orchestrator initialized.
2025-01-11 14:09:15,507 - app_logger - INFO - Starting background tasks...
2025-01-11 14:09:15,507 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 14:09:15,553 - app_logger - INFO - Flask server running on port 5002.
2025-01-11 14:09:30,824 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:09:30,824 - app_logger - INFO - Starting to process event data...
2025-01-11 14:09:31,255 - app_logger - INFO - Changes (1):
2025-01-11 14:09:31,255 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:09:31,256 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:09:31,256 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:09:31,257 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:09:31,258 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:09:31,788 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 14:09:32,794 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 14:09:32,839 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 14:09:32,840 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 14:09:32,849 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 14:09:32,849 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 14:09:32,850 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 14:09:33,037 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:09:34,624 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 14:09:34,625 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 14:09:34,643 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:09:34,647 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 14:09:34,654 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 14:09:34,655 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:09:34,668 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:09:34,668 - app_logger - INFO - Starting to process event data...
2025-01-11 14:09:34,850 - app_logger - INFO - Changes (0):
2025-01-11 14:11:29,055 - app_logger - INFO - Shutting down the application...
2025-01-11 14:11:29,589 - app_logger - INFO - Starting the application...
2025-01-11 14:11:29,923 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 14:11:30,223 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 14:11:31,449 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 14:11:32,331 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 14:11:33,094 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 14:11:33,095 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 14:11:33,144 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 14:11:33,144 - app_logger - INFO - Monday Service initialized
2025-01-11 14:11:33,145 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 14:11:33,146 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 14:11:33,192 - app_logger - INFO - OCR Service initialized
2025-01-11 14:11:33,192 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 14:11:33,255 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 14:11:33,255 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 14:11:33,255 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 14:11:33,263 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 14:11:33,286 - app_logger - INFO - Database initialized.
2025-01-11 14:11:33,286 - app_logger - INFO - Orchestrator initialized.
2025-01-11 14:11:33,286 - app_logger - INFO - Starting background tasks...
2025-01-11 14:11:33,287 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 14:11:33,322 - app_logger - INFO - Flask server running on port 5002.
2025-01-11 14:11:42,568 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:11:42,568 - app_logger - INFO - Starting to process event data...
2025-01-11 14:11:42,838 - app_logger - INFO - Changes (1):
2025-01-11 14:11:42,838 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:11:42,838 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:11:42,838 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:11:42,839 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:11:42,839 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:11:43,361 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 14:11:44,303 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 14:11:44,347 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 14:11:44,348 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 14:11:44,352 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 14:11:44,353 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 14:11:44,353 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 14:11:44,541 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:11:45,998 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 14:11:45,999 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 14:11:46,016 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:11:46,023 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 14:11:46,034 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 14:11:46,036 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:11:46,051 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:11:46,051 - app_logger - INFO - Starting to process event data...
2025-01-11 14:11:46,232 - app_logger - INFO - Changes (0):
2025-01-11 14:17:04,327 - app_logger - INFO - Shutting down the application...
2025-01-11 14:17:04,977 - app_logger - INFO - Starting the application...
2025-01-11 14:17:05,341 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 14:17:05,627 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 14:17:06,818 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 14:17:08,908 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 14:17:10,056 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 14:17:10,059 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 14:17:10,124 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 14:17:10,124 - app_logger - INFO - Monday Service initialized
2025-01-11 14:17:10,125 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 14:17:10,125 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 14:17:10,177 - app_logger - INFO - OCR Service initialized
2025-01-11 14:17:10,177 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 14:17:10,241 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 14:17:10,242 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 14:17:10,242 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 14:17:10,249 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 14:17:10,275 - app_logger - INFO - Database initialized.
2025-01-11 14:17:10,275 - app_logger - INFO - Orchestrator initialized.
2025-01-11 14:17:10,275 - app_logger - INFO - Starting background tasks...
2025-01-11 14:17:10,275 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 14:17:10,315 - app_logger - INFO - Flask server running on port 5002.
2025-01-11 14:17:15,110 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:17:15,110 - app_logger - INFO - Starting to process event data...
2025-01-11 14:17:15,332 - app_logger - INFO - Changes (1):
2025-01-11 14:17:15,332 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:17:15,332 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:17:15,332 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:17:15,332 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:17:15,333 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:17:15,985 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 14:17:17,067 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 14:17:17,105 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 14:17:17,106 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 14:17:17,110 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 14:17:17,111 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 14:17:17,111 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 14:17:17,297 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:17:18,817 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 14:17:18,817 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 14:17:18,826 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:17:18,830 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 14:17:18,839 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 14:17:18,853 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:17:18,867 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:17:18,867 - app_logger - INFO - Starting to process event data...
2025-01-11 14:17:19,034 - app_logger - INFO - Changes (0):
2025-01-11 14:17:41,528 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:17:41,532 - app_logger - INFO - Starting to process event data...
2025-01-11 14:17:41,775 - app_logger - INFO - Changes (1):
2025-01-11 14:17:41,776 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:17:41,776 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:17:41,776 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:17:41,776 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:17:41,776 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:17:42,148 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 14:17:42,888 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 14:17:42,896 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 14:17:42,898 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 14:17:42,903 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 14:17:42,905 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 14:17:42,905 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 14:17:42,915 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:17:44,482 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 14:17:44,483 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 14:17:44,495 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:17:44,501 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 14:17:44,510 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 14:17:44,512 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:17:44,528 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:17:44,529 - app_logger - INFO - Starting to process event data...
2025-01-11 14:17:44,672 - app_logger - INFO - Changes (0):
2025-01-11 14:18:20,381 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:18:20,384 - app_logger - INFO - Starting to process event data...
2025-01-11 14:18:20,554 - app_logger - INFO - Changes (1):
2025-01-11 14:18:20,555 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:18:20,555 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:18:20,555 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:18:20,555 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:18:20,556 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:18:20,826 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 14:18:21,670 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 14:18:21,680 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 14:18:21,684 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 14:18:21,690 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 14:18:21,692 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 14:18:21,692 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 14:18:21,704 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:18:23,422 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 14:18:23,423 - app_logger - INFO - ü§ù Checking if Invoice(id=87) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 14:18:23,445 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:18:23,450 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 14:18:23,458 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 14:18:23,460 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:18:23,476 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:18:23,476 - app_logger - INFO - Starting to process event data...
2025-01-11 14:18:23,640 - app_logger - INFO - Changes (0):
2025-01-11 14:21:59,877 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:21:59,877 - app_logger - INFO - Starting to process event data...
2025-01-11 14:22:00,178 - app_logger - INFO - Changes (1):
2025-01-11 14:22:00,178 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:22:00,178 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:22:00,179 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:22:00,179 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:22:00,179 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:22:00,740 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 14:22:01,689 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 14:22:01,699 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 14:22:01,701 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 14:22:01,710 - app_logger - INFO - üôÖ No Invoices matched.
2025-01-11 14:22:01,711 - app_logger - INFO - üÜï Creating new invoice #1 for PO 21 (project 2416).
2025-01-11 14:22:01,711 - app_logger - INFO - üå± About to insert a fresh record into Invoice with {'project_number': 2416, 'po_number': 21, 'invoice_number': 1, 'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 14:22:01,721 - app_logger - INFO - üéâ Creation successful! Record is now in the DB.
2025-01-11 14:22:03,332 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 14:22:03,333 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 14:22:03,347 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:22:03,349 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 14:22:03,351 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 14:22:03,352 - app_logger - INFO - ü§ù Updating an existing DetailItem for project_number=2416, po_number=21, detail_number=1, line_id=1
2025-01-11 14:22:03,363 - app_logger - INFO - ‚úÖ The DetailItem has been updated successfully.
2025-01-11 14:22:03,367 - app_logger - INFO - Linked invoice_id=88 to detail_item #1 (DB ID=6222).
2025-01-11 14:22:03,367 - app_logger - INFO - ü§ù Updating an existing DetailItem for project_number=2416, po_number=21, detail_number=1, line_id=2
2025-01-11 14:22:03,375 - app_logger - INFO - ‚úÖ The DetailItem has been updated successfully.
2025-01-11 14:22:03,379 - app_logger - INFO - Linked invoice_id=88 to detail_item #1 (DB ID=6223).
2025-01-11 14:22:03,379 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:22:03,391 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:22:03,391 - app_logger - INFO - Starting to process event data...
2025-01-11 14:22:03,523 - app_logger - INFO - Changes (0):
2025-01-11 14:26:05,807 - app_logger - INFO - Shutting down the application...
2025-01-11 14:26:06,317 - app_logger - INFO - Starting the application...
2025-01-11 14:26:06,595 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 14:26:06,891 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 14:26:08,077 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 14:26:08,841 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 14:26:09,701 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 14:26:09,702 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 14:26:09,749 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 14:26:09,749 - app_logger - INFO - Monday Service initialized
2025-01-11 14:26:09,749 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 14:26:09,750 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 14:26:09,799 - app_logger - INFO - OCR Service initialized
2025-01-11 14:26:09,799 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 14:26:09,861 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 14:26:09,861 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 14:26:09,862 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 14:26:09,869 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 14:26:09,895 - app_logger - INFO - Database initialized.
2025-01-11 14:26:09,896 - app_logger - INFO - Orchestrator initialized.
2025-01-11 14:26:09,896 - app_logger - INFO - Starting background tasks...
2025-01-11 14:26:09,896 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 14:26:09,933 - app_logger - INFO - Flask server running on port 5002.
2025-01-11 14:27:54,506 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:27:54,507 - app_logger - INFO - Starting to process event data...
2025-01-11 14:27:54,824 - app_logger - INFO - Changes (1):
2025-01-11 14:27:54,824 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:27:54,825 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:27:54,825 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:27:54,825 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:27:54,826 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:27:55,414 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 14:27:56,374 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 14:27:56,414 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 14:27:56,415 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 14:27:56,419 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 14:27:56,420 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 14:27:56,420 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 14:27:56,604 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:27:57,967 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 14:27:57,967 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 14:27:57,973 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:27:57,979 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 14:27:57,988 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 14:27:57,989 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:27:58,002 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:27:58,003 - app_logger - INFO - Starting to process event data...
2025-01-11 14:27:58,172 - app_logger - INFO - Changes (0):
2025-01-11 14:29:59,620 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:29:59,621 - app_logger - INFO - Starting to process event data...
2025-01-11 14:29:59,896 - app_logger - INFO - Changes (1):
2025-01-11 14:29:59,896 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:29:59,897 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:29:59,897 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:29:59,897 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:29:59,897 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:30:00,469 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 14:30:01,472 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 14:30:01,479 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 14:30:01,481 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 14:30:01,487 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 14:30:01,488 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 14:30:01,489 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 14:30:01,500 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:30:03,663 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 14:30:03,663 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 14:30:03,674 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:30:03,679 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 14:30:03,684 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 14:30:03,687 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:30:03,700 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:30:03,701 - app_logger - INFO - Starting to process event data...
2025-01-11 14:30:03,842 - app_logger - INFO - Changes (0):
2025-01-11 14:31:19,694 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:31:19,695 - app_logger - INFO - Starting to process event data...
2025-01-11 14:31:19,940 - app_logger - INFO - Changes (1):
2025-01-11 14:31:19,941 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:31:19,942 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:31:19,942 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:31:19,943 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:31:19,943 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:31:20,306 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 14:31:21,116 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 14:31:21,129 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 14:31:21,130 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 14:31:21,135 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 14:31:21,136 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 14:31:21,137 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 14:31:21,143 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:31:22,697 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 14:31:22,698 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 14:31:22,708 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:31:22,711 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 14:31:22,715 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 14:31:22,717 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:31:22,730 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:31:22,730 - app_logger - INFO - Starting to process event data...
2025-01-11 14:31:22,912 - app_logger - INFO - Changes (0):
2025-01-11 14:50:21,458 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:50:21,459 - app_logger - INFO - Starting to process event data...
2025-01-11 14:50:21,761 - app_logger - INFO - Changes (1):
2025-01-11 14:50:21,762 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:50:21,762 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:50:21,762 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:50:21,762 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:50:21,762 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:50:22,315 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 14:50:23,531 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 14:50:23,534 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 14:50:23,535 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 14:50:23,541 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 14:50:23,545 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 14:50:23,546 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 14:50:23,550 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:50:26,474 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 14:50:26,474 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 14:50:26,480 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 14:50:26,483 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 14:50:26,486 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 14:50:26,487 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 14:50:26,500 - app_logger - INFO - Received Dropbox event.
2025-01-11 14:50:26,500 - app_logger - INFO - Starting to process event data...
2025-01-11 14:50:26,739 - app_logger - INFO - Changes (0):
2025-01-11 16:04:40,165 - app_logger - INFO - Shutting down the application...
2025-01-11 16:04:40,670 - app_logger - INFO - Starting the application...
2025-01-11 16:04:40,946 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 16:04:41,304 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 16:04:42,622 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 16:04:43,310 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 16:04:44,129 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 16:04:44,131 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 16:04:44,173 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 16:04:44,173 - app_logger - INFO - Monday Service initialized
2025-01-11 16:04:44,173 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 16:04:44,174 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 16:04:44,219 - app_logger - INFO - OCR Service initialized
2025-01-11 16:04:44,220 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 16:04:44,281 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 16:04:44,282 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 16:04:44,282 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 16:04:44,290 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 16:04:44,313 - app_logger - INFO - Database initialized.
2025-01-11 16:04:44,313 - app_logger - INFO - Orchestrator initialized.
2025-01-11 16:04:44,313 - app_logger - INFO - Starting background tasks...
2025-01-11 16:04:44,313 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 16:04:44,355 - app_logger - INFO - Flask server running on port 5002.
2025-01-11 16:05:04,252 - app_logger - INFO - Received Dropbox event.
2025-01-11 16:05:04,253 - app_logger - INFO - Starting to process event data...
2025-01-11 16:05:04,472 - app_logger - INFO - Changes (1):
2025-01-11 16:05:04,472 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:05:04,472 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:05:04,473 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:05:04,473 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:05:04,474 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:05:05,565 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 16:05:06,533 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 16:05:06,571 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 16:05:06,572 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 16:05:06,579 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 16:05:06,579 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 16:05:06,580 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 16:05:06,753 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 16:05:08,312 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 16:05:08,313 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 16:05:08,319 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 16:05:08,321 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 16:05:08,329 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 16:05:08,331 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:05:08,345 - app_logger - INFO - Received Dropbox event.
2025-01-11 16:05:08,345 - app_logger - INFO - Starting to process event data...
2025-01-11 16:05:08,515 - app_logger - INFO - Changes (0):
2025-01-11 16:11:07,072 - app_logger - INFO - Received Dropbox event.
2025-01-11 16:11:07,073 - app_logger - INFO - Starting to process event data...
2025-01-11 16:11:07,372 - app_logger - INFO - Changes (1):
2025-01-11 16:11:07,374 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:11:07,379 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:11:07,380 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:11:07,380 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:11:07,380 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:11:07,926 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 16:11:08,826 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 16:11:08,832 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 16:11:08,833 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 16:11:08,838 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 16:11:08,839 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 16:11:08,839 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 16:11:08,845 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 16:11:10,879 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 16:11:10,881 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 16:11:10,893 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 16:11:10,912 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 16:11:10,919 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 16:11:10,924 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:11:10,940 - app_logger - INFO - Received Dropbox event.
2025-01-11 16:11:10,940 - app_logger - INFO - Starting to process event data...
2025-01-11 16:11:11,262 - app_logger - INFO - Changes (0):
2025-01-11 16:47:56,420 - app_logger - INFO - Received Dropbox event.
2025-01-11 16:47:56,423 - app_logger - INFO - Starting to process event data...
2025-01-11 16:47:56,746 - app_logger - INFO - Changes (1):
2025-01-11 16:47:56,746 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:47:56,746 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:47:56,747 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:47:56,747 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:47:56,747 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:47:57,331 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 16:47:58,320 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 16:47:58,330 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 16:47:58,336 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 16:47:58,342 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 16:47:58,344 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 16:47:58,345 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 16:47:58,357 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 16:47:59,835 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 16:47:59,835 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 16:47:59,842 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 16:47:59,846 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 16:47:59,851 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 16:47:59,853 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 16:47:59,865 - app_logger - INFO - Received Dropbox event.
2025-01-11 16:47:59,865 - app_logger - INFO - Starting to process event data...
2025-01-11 16:48:00,039 - app_logger - INFO - Changes (0):
2025-01-11 17:37:49,880 - app_logger - INFO - Received Dropbox event.
2025-01-11 17:37:49,882 - app_logger - INFO - Starting to process event data...
2025-01-11 17:37:50,209 - app_logger - INFO - Changes (1):
2025-01-11 17:37:50,213 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:37:50,213 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:37:50,214 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:37:50,214 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:37:50,215 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:37:50,739 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 17:37:51,570 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 17:37:51,574 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 17:37:51,575 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 17:37:51,577 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 17:37:51,578 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 17:37:51,578 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 17:37:51,582 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 17:37:53,237 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 17:37:53,238 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 17:37:53,245 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 17:37:53,247 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 17:37:53,250 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 17:37:53,252 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:37:53,265 - app_logger - INFO - Received Dropbox event.
2025-01-11 17:37:53,265 - app_logger - INFO - Starting to process event data...
2025-01-11 17:37:53,421 - app_logger - INFO - Changes (0):
2025-01-11 17:42:11,658 - app_logger - INFO - Shutting down the application...
2025-01-11 17:42:13,224 - app_logger - INFO - Starting the application...
2025-01-11 17:42:13,384 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 17:42:13,565 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 17:42:14,547 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 17:42:15,201 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 17:42:16,199 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 17:42:16,200 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 17:42:16,224 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 17:42:16,224 - app_logger - INFO - Monday Service initialized
2025-01-11 17:42:16,225 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 17:42:16,225 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 17:42:16,259 - app_logger - INFO - OCR Service initialized
2025-01-11 17:42:16,259 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 17:42:16,319 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 17:42:16,320 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 17:42:16,320 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 17:42:16,323 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 17:42:16,337 - app_logger - INFO - Database initialized.
2025-01-11 17:42:16,337 - app_logger - INFO - Orchestrator initialized.
2025-01-11 17:42:16,337 - app_logger - INFO - Starting background tasks...
2025-01-11 17:42:16,337 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 17:42:16,409 - app_logger - INFO - Flask server running on port 5002.
2025-01-11 17:42:48,621 - app_logger - INFO - Received Dropbox event.
2025-01-11 17:42:48,621 - app_logger - INFO - Starting to process event data...
2025-01-11 17:42:48,830 - app_logger - INFO - Changes (1):
2025-01-11 17:42:48,830 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:42:48,830 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:42:48,831 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:42:48,831 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:42:48,831 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:42:49,960 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 17:42:50,689 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 17:42:50,702 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 17:42:50,703 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 17:42:50,705 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 17:42:50,707 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 17:42:50,707 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 17:42:50,786 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 17:42:52,269 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 17:42:52,270 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 17:42:52,281 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 17:42:52,283 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 17:42:52,287 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 17:42:52,288 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:42:52,305 - app_logger - INFO - Received Dropbox event.
2025-01-11 17:42:52,305 - app_logger - INFO - Starting to process event data...
2025-01-11 17:42:52,601 - app_logger - INFO - Changes (0):
2025-01-11 17:52:25,719 - app_logger - INFO - Received Dropbox event.
2025-01-11 17:52:25,720 - app_logger - INFO - Starting to process event data...
2025-01-11 17:52:25,984 - app_logger - INFO - Changes (1):
2025-01-11 17:52:25,984 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:52:25,984 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:52:25,984 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:52:25,984 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:52:25,984 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:52:26,476 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 17:52:27,195 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 17:52:27,203 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 17:52:27,206 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 17:52:27,212 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 17:52:27,215 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 17:52:27,216 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 17:52:27,230 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 17:52:29,361 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 17:52:29,362 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 17:52:29,368 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 17:52:29,371 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 17:52:29,386 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 17:52:29,389 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:52:29,405 - app_logger - INFO - Received Dropbox event.
2025-01-11 17:52:29,405 - app_logger - INFO - Starting to process event data...
2025-01-11 17:52:29,700 - app_logger - INFO - Changes (0):
2025-01-11 17:54:58,698 - app_logger - INFO - Received Dropbox event.
2025-01-11 17:54:58,699 - app_logger - INFO - Starting to process event data...
2025-01-11 17:54:59,006 - app_logger - INFO - Changes (1):
2025-01-11 17:54:59,007 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:54:59,007 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:54:59,007 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:54:59,007 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:54:59,007 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:54:59,466 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 17:55:00,235 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 17:55:00,241 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 17:55:00,242 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 17:55:00,246 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 17:55:00,248 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 17:55:00,248 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 17:55:00,254 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 17:55:02,199 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 17:55:02,200 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 17:55:02,213 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 17:55:02,224 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 17:55:02,230 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 17:55:02,235 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:55:02,255 - app_logger - INFO - Received Dropbox event.
2025-01-11 17:55:02,256 - app_logger - INFO - Starting to process event data...
2025-01-11 17:55:02,553 - app_logger - INFO - Changes (0):
2025-01-11 17:55:57,169 - app_logger - INFO - Received Dropbox event.
2025-01-11 17:55:57,169 - app_logger - INFO - Starting to process event data...
2025-01-11 17:55:57,358 - app_logger - INFO - Changes (1):
2025-01-11 17:55:57,359 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:55:57,359 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:55:57,359 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:55:57,359 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:55:57,359 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:55:57,860 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 17:55:58,555 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 17:55:58,558 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 17:55:58,559 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 17:55:58,561 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 17:55:58,562 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 17:55:58,562 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 17:55:58,569 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 17:56:00,078 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 17:56:00,079 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 17:56:00,081 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 17:56:00,083 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 17:56:00,084 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 17:56:00,085 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 17:56:00,354 - app_logger - INFO - Received Dropbox event.
2025-01-11 17:56:00,354 - app_logger - INFO - Starting to process event data...
2025-01-11 17:56:00,490 - app_logger - INFO - Changes (0):
2025-01-11 18:21:25,639 - app_logger - INFO - Received Dropbox event.
2025-01-11 18:21:25,642 - app_logger - INFO - Starting to process event data...
2025-01-11 18:21:25,973 - app_logger - INFO - Changes (1):
2025-01-11 18:21:25,973 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 18:21:25,973 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 18:21:25,973 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 18:21:25,973 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 18:21:25,973 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 18:21:26,616 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 18:21:27,436 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 18:21:27,442 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 18:21:27,444 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 18:21:27,448 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 18:21:27,455 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 18:21:27,456 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 18:21:27,470 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 18:21:29,052 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 18:21:29,052 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 18:21:29,060 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 18:21:29,063 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 18:21:29,065 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 18:21:29,067 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 18:21:29,079 - app_logger - INFO - Received Dropbox event.
2025-01-11 18:21:29,079 - app_logger - INFO - Starting to process event data...
2025-01-11 18:21:29,238 - app_logger - INFO - Changes (0):
2025-01-11 18:55:44,254 - app_logger - INFO - Shutting down the application...
2025-01-11 18:55:44,765 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-11 18:55:44,765 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-11 18:55:44,765 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-11 18:55:44,765 - app_logger - INFO - Starting the application...
2025-01-11 18:55:45,052 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-11 18:55:45,052 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 18:55:45,052 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-11 18:55:45,345 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 18:55:46,283 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 18:55:46,300 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-11 18:55:46,668 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 18:55:47,473 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 18:55:47,473 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 18:55:47,473 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-11 18:55:48,028 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-11 18:55:48,505 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 18:55:48,505 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-11 18:55:48,506 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-11 18:55:48,507 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 18:55:48,507 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-11 18:55:48,560 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 18:55:48,561 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 18:55:48,561 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-11 18:55:48,561 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 18:55:48,561 - app_logger - INFO - Monday Service initialized
2025-01-11 18:55:48,561 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-11 18:55:48,562 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 18:55:48,562 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 18:55:48,562 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-11 18:55:48,562 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 18:55:48,562 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-11 18:55:48,602 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 18:55:48,602 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 18:55:48,607 - app_logger - INFO - OCR Service initialized
2025-01-11 18:55:48,607 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-11 18:55:48,607 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 18:55:48,607 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 18:55:48,608 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 18:55:48,608 - app_logger - DEBUG - Initialized XeroServices.
2025-01-11 18:55:48,609 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-11 18:55:48,667 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 18:55:48,667 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 18:55:48,667 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 18:55:48,667 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 18:55:48,667 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 18:55:48,667 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 18:55:48,667 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-11 18:55:48,668 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 18:55:48,668 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-11 18:55:48,669 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 18:55:48,676 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 18:55:48,700 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-11 18:55:48,700 - app_logger - INFO - Database initialized.
2025-01-11 18:55:48,700 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 18:55:48,700 - app_logger - INFO - Orchestrator initialized.
2025-01-11 18:55:48,700 - app_logger - INFO - Starting background tasks...
2025-01-11 18:55:48,700 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 18:55:48,747 - app_logger - INFO - Flask server running on port 5002.
2025-01-11 18:57:17,505 - app_logger - INFO - Received Dropbox event.
2025-01-11 18:57:17,505 - app_logger - INFO - Starting to process event data...
2025-01-11 18:57:17,506 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 18:57:17,812 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 18:57:17,813 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 18:57:17,813 - app_logger - INFO - Changes (1):
2025-01-11 18:57:17,813 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 18:57:17,813 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 18:57:17,813 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 18:57:17,813 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 18:57:17,814 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 18:57:18,796 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 18:57:19,743 - app_logger - DEBUG - ü§î Checking for PurchaseOrders with (project_number='2416', po_number='21').
2025-01-11 18:57:19,744 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 18:57:19,782 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 18:57:19,782 - app_logger - DEBUG - ü§ì Pulling record: 1448 from table purchase_order
2025-01-11 18:57:19,782 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 18:57:19,782 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 18:57:19,786 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 18:57:19,786 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 18:57:19,787 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 18:57:19,787 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=88), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 18:57:19,787 - app_logger - DEBUG - üîß Attempting to update Invoice(id=88). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 18:57:19,787 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 18:57:19,790 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=88) updated.
2025-01-11 18:57:19,790 - app_logger - ERROR - üí• Had an issue updating Invoice: 'str' object has no attribute 'process_invoice_trigger'
Traceback (most recent call last):
  File "/Users/haske107/PycharmProjects/Dropbox Listener/database/database_util.py", line 176, in _update_record
    session.commit()
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/scoping.py", line 597, in commit
    return self._proxied.commit()
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2028, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4352, in flush
    self._flush(objects)
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4487, in _flush
    with util.safe_reraise():
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    flush_context.execute()
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 101, in save_obj
    _finalize_insert_update_commands(
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1566, in _finalize_insert_update_commands
    mapper.dispatch.after_update(mapper, connection, state)
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/event/attr.py", line 497, in __call__
    fn(*args, **kw)
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/events.py", line 891, in wrap
    fn(*arg, **kw)
  File "/Users/haske107/PycharmProjects/Dropbox Listener/database/database_trigger.py", line 229, in invoice_after_update
    _enqueue_invoice_update(target.id)
  File "/Users/haske107/PycharmProjects/Dropbox Listener/database/database_trigger.py", line 71, in _enqueue_invoice_update
    celery_tasks_instance.process_invoice_trigger.delay(invoice_id)
AttributeError: 'str' object has no attribute 'process_invoice_trigger'
2025-01-11 18:57:20,396 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 18:57:21,209 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 18:57:21,209 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 18:57:21,209 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=88), data={'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 18:57:21,210 - app_logger - DEBUG - üîß Attempting to update Invoice(id=88). Fields: {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 18:57:21,210 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 18:57:21,212 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=88) updated.
2025-01-11 18:57:21,213 - app_logger - ERROR - üí• Had an issue updating Invoice: 'str' object has no attribute 'process_invoice_trigger'
Traceback (most recent call last):
  File "/Users/haske107/PycharmProjects/Dropbox Listener/database/database_util.py", line 176, in _update_record
    session.commit()
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/scoping.py", line 597, in commit
    return self._proxied.commit()
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2028, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4352, in flush
    self._flush(objects)
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4487, in _flush
    with util.safe_reraise():
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    flush_context.execute()
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 101, in save_obj
    _finalize_insert_update_commands(
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1566, in _finalize_insert_update_commands
    mapper.dispatch.after_update(mapper, connection, state)
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/event/attr.py", line 497, in __call__
    fn(*args, **kw)
  File "/Users/haske107/Documents/Dropbox Listener/lib/python3.10/site-packages/sqlalchemy/orm/events.py", line 891, in wrap
    fn(*arg, **kw)
  File "/Users/haske107/PycharmProjects/Dropbox Listener/database/database_trigger.py", line 229, in invoice_after_update
    _enqueue_invoice_update(target.id)
  File "/Users/haske107/PycharmProjects/Dropbox Listener/database/database_trigger.py", line 71, in _enqueue_invoice_update
    celery_tasks_instance.process_invoice_trigger.delay(invoice_id)
AttributeError: 'str' object has no attribute 'process_invoice_trigger'
2025-01-11 18:57:21,213 - app_logger - DEBUG - üîé search_detail_items: columns=['po_id', 'detail_number', 'payment_type'], values=[1448, 1, 'INV']
2025-01-11 18:57:21,214 - app_logger - DEBUG - üïµÔ∏è Searching DetailItem with filters: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 18:57:21,214 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 18:57:21,221 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 18:57:21,222 - app_logger - DEBUG - ü§ì Pulling record: 6222 from table detail_item
2025-01-11 18:57:21,222 - app_logger - DEBUG - ü§ì Pulling record: 6223 from table detail_item
2025-01-11 18:57:21,223 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 18:57:21,223 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 18:57:21,237 - app_logger - INFO - Received Dropbox event.
2025-01-11 18:57:21,237 - app_logger - INFO - Starting to process event data...
2025-01-11 18:57:21,237 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 18:57:21,391 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 18:57:21,393 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 18:57:21,393 - app_logger - INFO - Changes (0):
2025-01-11 18:57:21,394 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 19:02:04,399 - app_logger - INFO - Shutting down the application...
2025-01-11 19:02:04,949 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-11 19:02:04,949 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-11 19:02:04,949 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-11 19:02:04,950 - app_logger - INFO - Starting the application...
2025-01-11 19:02:05,241 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-11 19:02:05,242 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 19:02:05,242 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-11 19:02:05,544 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 19:02:06,277 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 19:02:06,297 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-11 19:02:06,684 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 19:02:07,502 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 19:02:07,503 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 19:02:07,503 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-11 19:02:08,009 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-11 19:02:08,328 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 19:02:08,328 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-11 19:02:08,330 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-11 19:02:08,330 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 19:02:08,330 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-11 19:02:08,382 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 19:02:08,382 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:02:08,382 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-11 19:02:08,382 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:02:08,382 - app_logger - INFO - Monday Service initialized
2025-01-11 19:02:08,382 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-11 19:02:08,383 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 19:02:08,383 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:02:08,383 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-11 19:02:08,384 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 19:02:08,384 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-11 19:02:08,424 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 19:02:08,429 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:02:08,434 - app_logger - INFO - OCR Service initialized
2025-01-11 19:02:08,434 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-11 19:02:08,434 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 19:02:08,434 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 19:02:08,435 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:02:08,435 - app_logger - DEBUG - Initialized XeroServices.
2025-01-11 19:02:08,435 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-11 19:02:08,495 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 19:02:08,495 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:02:08,495 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 19:02:08,495 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 19:02:08,496 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 19:02:08,496 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 19:02:08,496 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-11 19:02:08,496 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 19:02:08,496 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-11 19:02:08,497 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 19:02:08,571 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:02:08,571 - app_logger - DEBUG - Created a new instance of DatabaseTriggerService.
2025-01-11 19:02:08,573 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 19:02:08,599 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-11 19:02:08,599 - app_logger - INFO - Database initialized.
2025-01-11 19:02:08,599 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 19:02:08,599 - app_logger - INFO - Orchestrator initialized.
2025-01-11 19:02:08,599 - app_logger - INFO - Starting background tasks...
2025-01-11 19:02:08,599 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 19:02:08,641 - app_logger - INFO - Flask server running on port 5002.
2025-01-11 19:02:22,553 - app_logger - INFO - Received Dropbox event.
2025-01-11 19:02:22,554 - app_logger - INFO - Starting to process event data...
2025-01-11 19:02:22,555 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 19:02:22,848 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 19:02:22,849 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 19:02:22,849 - app_logger - INFO - Changes (1):
2025-01-11 19:02:22,850 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:02:22,850 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:02:22,850 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:02:22,850 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:02:22,850 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:02:23,363 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 19:02:24,267 - app_logger - DEBUG - ü§î Checking for PurchaseOrders with (project_number='2416', po_number='21').
2025-01-11 19:02:24,268 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 19:02:24,306 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 19:02:24,306 - app_logger - DEBUG - ü§ì Pulling record: 1448 from table purchase_order
2025-01-11 19:02:24,307 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 19:02:24,307 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 19:02:24,311 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 19:02:24,311 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:02:24,312 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 19:02:24,312 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=88), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 19:02:24,312 - app_logger - DEBUG - üîß Attempting to update Invoice(id=88). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 19:02:24,312 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 19:02:24,315 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=88) updated.
2025-01-11 19:02:24,387 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 19:02:24,389 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:02:25,007 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 19:02:26,135 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 19:02:26,135 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 19:02:26,135 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=88), data={'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 19:02:26,135 - app_logger - DEBUG - üîß Attempting to update Invoice(id=88). Fields: {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 19:02:26,135 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 19:02:26,137 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=88) updated.
2025-01-11 19:02:26,139 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 19:02:26,140 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:02:26,143 - app_logger - DEBUG - üîé search_detail_items: columns=['po_id', 'detail_number', 'payment_type'], values=[1448, 1, 'INV']
2025-01-11 19:02:26,143 - app_logger - DEBUG - üïµÔ∏è Searching DetailItem with filters: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 19:02:26,143 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 19:02:26,148 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 19:02:26,148 - app_logger - DEBUG - ü§ì Pulling record: 6222 from table detail_item
2025-01-11 19:02:26,148 - app_logger - DEBUG - ü§ì Pulling record: 6223 from table detail_item
2025-01-11 19:02:26,149 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:02:26,150 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 19:02:26,162 - app_logger - INFO - Received Dropbox event.
2025-01-11 19:02:26,163 - app_logger - INFO - Starting to process event data...
2025-01-11 19:02:26,163 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 19:02:26,540 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 19:02:26,542 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 19:02:26,542 - app_logger - INFO - Changes (0):
2025-01-11 19:02:26,543 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 19:10:24,059 - app_logger - INFO - Received Dropbox event.
2025-01-11 19:10:24,060 - app_logger - INFO - Starting to process event data...
2025-01-11 19:10:24,060 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 19:10:24,410 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 19:10:24,413 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 19:10:24,414 - app_logger - INFO - Changes (1):
2025-01-11 19:10:24,414 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:10:24,415 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:10:24,415 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:10:24,415 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:10:24,416 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:10:24,910 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 19:10:25,857 - app_logger - DEBUG - ü§î Checking for PurchaseOrders with (project_number='2416', po_number='21').
2025-01-11 19:10:25,859 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 19:10:25,882 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 19:10:25,883 - app_logger - DEBUG - ü§ì Pulling record: 1448 from table purchase_order
2025-01-11 19:10:25,885 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 19:10:25,885 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 19:10:25,890 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 19:10:25,891 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:10:25,892 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 19:10:25,892 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=88), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 19:10:25,893 - app_logger - DEBUG - üîß Attempting to update Invoice(id=88). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 19:10:25,894 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 19:10:25,902 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=88) updated.
2025-01-11 19:10:25,907 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 19:10:25,910 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:10:26,523 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 19:10:27,435 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 19:10:27,437 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 19:10:27,437 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=88), data={'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 19:10:27,437 - app_logger - DEBUG - üîß Attempting to update Invoice(id=88). Fields: {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 19:10:27,438 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 19:10:27,444 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=88) updated.
2025-01-11 19:10:27,449 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 19:10:27,451 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:10:27,457 - app_logger - DEBUG - üîé search_detail_items: columns=['po_id', 'detail_number', 'payment_type'], values=[1448, 1, 'INV']
2025-01-11 19:10:27,458 - app_logger - DEBUG - üïµÔ∏è Searching DetailItem with filters: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 19:10:27,458 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 19:10:27,469 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 19:10:27,470 - app_logger - DEBUG - ü§ì Pulling record: 6222 from table detail_item
2025-01-11 19:10:27,470 - app_logger - DEBUG - ü§ì Pulling record: 6223 from table detail_item
2025-01-11 19:10:27,476 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:10:27,478 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 19:10:27,491 - app_logger - INFO - Received Dropbox event.
2025-01-11 19:10:27,492 - app_logger - INFO - Starting to process event data...
2025-01-11 19:10:27,492 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 19:10:27,678 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 19:10:27,683 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 19:10:27,683 - app_logger - INFO - Changes (0):
2025-01-11 19:10:27,686 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 19:12:23,746 - app_logger - INFO - Received Dropbox event.
2025-01-11 19:12:23,747 - app_logger - INFO - Starting to process event data...
2025-01-11 19:12:23,748 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 19:12:24,077 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 19:12:24,082 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 19:12:24,083 - app_logger - INFO - Changes (1):
2025-01-11 19:12:24,083 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:12:24,084 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:12:24,084 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:12:24,084 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:12:24,085 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:12:24,558 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 19:12:25,452 - app_logger - DEBUG - ü§î Checking for PurchaseOrders with (project_number='2416', po_number='21').
2025-01-11 19:12:25,453 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 19:12:25,463 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 19:12:25,464 - app_logger - DEBUG - ü§ì Pulling record: 1448 from table purchase_order
2025-01-11 19:12:25,466 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 19:12:25,466 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 19:12:25,473 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 19:12:25,474 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:12:25,475 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 19:12:25,475 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=88), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 19:12:25,476 - app_logger - DEBUG - üîß Attempting to update Invoice(id=88). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 19:12:25,476 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 19:12:25,479 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=88) updated.
2025-01-11 19:12:25,482 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 19:12:25,485 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:12:26,203 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 19:12:27,348 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 19:12:27,349 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 19:12:27,349 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=88), data={'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 19:12:27,349 - app_logger - DEBUG - üîß Attempting to update Invoice(id=88). Fields: {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 19:12:27,350 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 19:12:27,356 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=88) updated.
2025-01-11 19:12:27,360 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 19:12:27,363 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:12:27,364 - app_logger - DEBUG - üîé search_detail_items: columns=['po_id', 'detail_number', 'payment_type'], values=[1448, 1, 'INV']
2025-01-11 19:12:27,365 - app_logger - DEBUG - üïµÔ∏è Searching DetailItem with filters: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 19:12:27,365 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 19:12:27,370 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 19:12:27,370 - app_logger - DEBUG - ü§ì Pulling record: 6222 from table detail_item
2025-01-11 19:12:27,370 - app_logger - DEBUG - ü§ì Pulling record: 6223 from table detail_item
2025-01-11 19:12:27,372 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:12:27,373 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 19:12:27,389 - app_logger - INFO - Received Dropbox event.
2025-01-11 19:12:27,389 - app_logger - INFO - Starting to process event data...
2025-01-11 19:12:27,390 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 19:12:27,535 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 19:12:27,539 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 19:12:27,540 - app_logger - INFO - Changes (0):
2025-01-11 19:12:27,542 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 19:16:00,985 - app_logger - INFO - Received Dropbox event.
2025-01-11 19:16:00,985 - app_logger - INFO - Starting to process event data...
2025-01-11 19:16:00,985 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 19:16:01,281 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 19:16:01,282 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 19:16:01,285 - app_logger - DEBUG - DELETE: DeletedMetadata(name='2416_21_01 Jordan Sakai Invoice.pdf', parent_shared_folder_id=NOT_SET, path_display='/2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf', path_lower='/2416 - whop keynote/1. purchase orders/2416_21 jordan sakai/2416_21_01 jordan sakai invoice.pdf', preview_url=NOT_SET)
2025-01-11 19:16:01,286 - app_logger - INFO - Changes (0):
2025-01-11 19:16:01,288 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 19:16:04,277 - app_logger - INFO - Received Dropbox event.
2025-01-11 19:16:04,277 - app_logger - INFO - Starting to process event data...
2025-01-11 19:16:04,277 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 19:16:04,473 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 19:16:04,479 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 19:16:04,479 - app_logger - INFO - Changes (1):
2025-01-11 19:16:04,479 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:16:04,479 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:16:04,480 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:16:04,480 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:16:04,480 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:16:04,931 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 19:16:05,947 - app_logger - DEBUG - ü§î Checking for PurchaseOrders with (project_number='2416', po_number='21').
2025-01-11 19:16:05,948 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 19:16:05,955 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 19:16:05,956 - app_logger - DEBUG - ü§ì Pulling record: 1448 from table purchase_order
2025-01-11 19:16:05,958 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 19:16:05,958 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 19:16:05,965 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 19:16:05,966 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:16:05,967 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 19:16:05,968 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=88), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 19:16:05,969 - app_logger - DEBUG - üîß Attempting to update Invoice(id=88). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 19:16:05,969 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 19:16:05,976 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=88) updated.
2025-01-11 19:16:05,981 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 19:16:05,984 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:16:06,601 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 19:16:07,584 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 19:16:07,585 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 19:16:07,586 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=88), data={'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 19:16:07,586 - app_logger - DEBUG - üîß Attempting to update Invoice(id=88). Fields: {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 19:16:07,587 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 19:16:07,600 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=88) updated.
2025-01-11 19:16:07,611 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 19:16:07,615 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:16:07,616 - app_logger - DEBUG - üîé search_detail_items: columns=['po_id', 'detail_number', 'payment_type'], values=[1448, 1, 'INV']
2025-01-11 19:16:07,616 - app_logger - DEBUG - üïµÔ∏è Searching DetailItem with filters: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 19:16:07,616 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 19:16:07,621 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 19:16:07,622 - app_logger - DEBUG - ü§ì Pulling record: 6222 from table detail_item
2025-01-11 19:16:07,622 - app_logger - DEBUG - ü§ì Pulling record: 6223 from table detail_item
2025-01-11 19:16:07,624 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:16:07,625 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 19:18:07,062 - app_logger - INFO - Received Dropbox event.
2025-01-11 19:18:07,063 - app_logger - INFO - Starting to process event data...
2025-01-11 19:18:07,063 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 19:18:07,409 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 19:18:07,410 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 19:18:07,410 - app_logger - INFO - Changes (1):
2025-01-11 19:18:07,410 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:18:07,410 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:18:07,410 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:18:07,410 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:18:07,410 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:18:07,916 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 19:18:08,793 - app_logger - DEBUG - ü§î Checking for PurchaseOrders with (project_number='2416', po_number='21').
2025-01-11 19:18:08,794 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 19:18:08,799 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 19:18:08,799 - app_logger - DEBUG - ü§ì Pulling record: 1448 from table purchase_order
2025-01-11 19:18:08,800 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 19:18:08,801 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 19:18:08,807 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 19:18:08,807 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:18:08,808 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 19:18:08,808 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=88), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 19:18:08,808 - app_logger - DEBUG - üîß Attempting to update Invoice(id=88). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 19:18:08,808 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 19:18:08,812 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=88) updated.
2025-01-11 19:18:08,816 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 19:18:08,817 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:18:09,432 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 19:18:10,448 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 19:18:10,449 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 19:18:10,449 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=88), data={'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 19:18:10,449 - app_logger - DEBUG - üîß Attempting to update Invoice(id=88). Fields: {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 19:18:10,449 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 19:18:10,453 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=88) updated.
2025-01-11 19:18:10,457 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 19:18:10,459 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:18:10,460 - app_logger - DEBUG - üîé search_detail_items: columns=['po_id', 'detail_number', 'payment_type'], values=[1448, 1, 'INV']
2025-01-11 19:18:10,460 - app_logger - DEBUG - üïµÔ∏è Searching DetailItem with filters: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 19:18:10,461 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 19:18:10,465 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 19:18:10,465 - app_logger - DEBUG - ü§ì Pulling record: 6222 from table detail_item
2025-01-11 19:18:10,465 - app_logger - DEBUG - ü§ì Pulling record: 6223 from table detail_item
2025-01-11 19:18:10,467 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:18:10,468 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 19:18:10,481 - app_logger - INFO - Received Dropbox event.
2025-01-11 19:18:10,482 - app_logger - INFO - Starting to process event data...
2025-01-11 19:18:10,482 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 19:18:10,629 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 19:18:10,631 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 19:18:10,631 - app_logger - INFO - Changes (0):
2025-01-11 19:18:10,632 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 19:22:15,061 - app_logger - INFO - Shutting down the application...
2025-01-11 19:22:15,546 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-11 19:22:15,546 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-11 19:22:15,546 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-11 19:22:15,546 - app_logger - INFO - Starting the application...
2025-01-11 19:22:15,823 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-11 19:22:15,823 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 19:22:15,823 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-11 19:22:16,162 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 19:22:16,882 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 19:22:16,902 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-11 19:22:17,298 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 19:22:18,080 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 19:22:18,081 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 19:22:18,081 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-11 19:22:18,629 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-11 19:22:18,968 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 19:22:18,969 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-11 19:22:18,971 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-11 19:22:18,971 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 19:22:18,971 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-11 19:22:19,022 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 19:22:19,022 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:22:19,022 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-11 19:22:19,022 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:22:19,022 - app_logger - INFO - Monday Service initialized
2025-01-11 19:22:19,022 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-11 19:22:19,023 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 19:22:19,023 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:22:19,023 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-11 19:22:19,023 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 19:22:19,023 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-11 19:22:19,064 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 19:22:19,065 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:22:19,069 - app_logger - INFO - OCR Service initialized
2025-01-11 19:22:19,070 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-11 19:22:19,070 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 19:22:19,070 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 19:22:19,071 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:22:19,071 - app_logger - DEBUG - Initialized XeroServices.
2025-01-11 19:22:19,071 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-11 19:22:19,131 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 19:22:19,131 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:22:19,131 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 19:22:19,131 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 19:22:19,132 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 19:22:19,132 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 19:22:19,132 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-11 19:22:19,132 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 19:22:19,132 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-11 19:22:19,133 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 19:22:19,140 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 19:22:19,163 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-11 19:22:19,163 - app_logger - INFO - Database initialized.
2025-01-11 19:22:19,163 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 19:22:19,163 - app_logger - INFO - Orchestrator initialized.
2025-01-11 19:22:19,163 - app_logger - INFO - Starting background tasks...
2025-01-11 19:22:19,164 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 19:22:19,204 - app_logger - INFO - Flask server running on port 5002.
2025-01-11 19:22:28,765 - app_logger - INFO - Received Dropbox event.
2025-01-11 19:22:28,765 - app_logger - INFO - Starting to process event data...
2025-01-11 19:22:28,766 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 19:22:28,928 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 19:22:28,931 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 19:22:28,931 - app_logger - INFO - Changes (1):
2025-01-11 19:22:28,931 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:22:28,931 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:22:28,932 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:22:28,932 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:22:28,932 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:22:29,401 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 19:22:30,279 - app_logger - DEBUG - ü§î Checking for PurchaseOrders with (project_number='2416', po_number='21').
2025-01-11 19:22:30,279 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 19:22:30,310 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 19:22:30,310 - app_logger - DEBUG - ü§ì Pulling record: 1448 from table purchase_order
2025-01-11 19:22:30,311 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 19:22:30,311 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 19:22:30,319 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 19:22:30,319 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:22:30,325 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 19:22:30,326 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=88), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 19:22:30,326 - app_logger - DEBUG - üîß Attempting to update Invoice(id=88). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 19:22:30,326 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 19:22:30,329 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=88) updated.
2025-01-11 19:22:30,437 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:22:30,437 - app_logger - DEBUG - Created a new instance of DatabaseTriggerService.
2025-01-11 19:22:30,501 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 19:22:30,504 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:22:31,099 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 19:22:31,844 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 19:22:31,845 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 19:22:31,845 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=88), data={'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 19:22:31,845 - app_logger - DEBUG - üîß Attempting to update Invoice(id=88). Fields: {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 19:22:31,845 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 19:22:31,852 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=88) updated.
2025-01-11 19:22:31,856 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 19:22:31,860 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:22:31,862 - app_logger - DEBUG - üîé search_detail_items: columns=['po_id', 'detail_number', 'payment_type'], values=[1448, 1, 'INV']
2025-01-11 19:22:31,862 - app_logger - DEBUG - üïµÔ∏è Searching DetailItem with filters: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 19:22:31,862 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 19:22:31,874 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 19:22:31,874 - app_logger - DEBUG - ü§ì Pulling record: 6222 from table detail_item
2025-01-11 19:22:31,874 - app_logger - DEBUG - ü§ì Pulling record: 6223 from table detail_item
2025-01-11 19:22:31,876 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:22:31,877 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 19:22:31,891 - app_logger - INFO - Received Dropbox event.
2025-01-11 19:22:31,891 - app_logger - INFO - Starting to process event data...
2025-01-11 19:22:31,891 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 19:22:32,085 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 19:22:32,088 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 19:22:32,088 - app_logger - INFO - Changes (0):
2025-01-11 19:22:32,089 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 19:41:49,501 - app_logger - INFO - Shutting down the application...
2025-01-11 19:41:50,008 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-11 19:41:50,008 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-11 19:41:50,008 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-11 19:41:50,008 - app_logger - INFO - Starting the application...
2025-01-11 19:41:50,337 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-11 19:41:50,337 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 19:41:50,337 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-11 19:41:50,758 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 19:41:53,072 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 19:41:53,091 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-11 19:41:53,533 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 19:41:54,286 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 19:41:54,286 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 19:41:54,286 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-11 19:41:55,306 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-11 19:41:55,592 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 19:41:55,592 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-11 19:41:55,596 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-11 19:41:55,596 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 19:41:55,597 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-11 19:41:55,660 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 19:41:55,661 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:41:55,661 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-11 19:41:55,661 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:41:55,661 - app_logger - INFO - Monday Service initialized
2025-01-11 19:41:55,661 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-11 19:41:55,664 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 19:41:55,664 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:41:55,664 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-11 19:41:55,666 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 19:41:55,666 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-11 19:41:55,731 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 19:41:55,731 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:41:55,737 - app_logger - INFO - OCR Service initialized
2025-01-11 19:41:55,737 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-11 19:41:55,737 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 19:41:55,737 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 19:41:55,738 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:41:55,738 - app_logger - DEBUG - Initialized XeroServices.
2025-01-11 19:41:55,739 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-11 19:41:55,820 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 19:41:55,820 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:41:55,820 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 19:41:55,820 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 19:41:55,820 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 19:41:55,821 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 19:41:55,821 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-11 19:41:55,822 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 19:41:55,822 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-11 19:41:55,823 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 19:41:55,831 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 19:41:55,856 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-11 19:41:55,856 - app_logger - INFO - Database initialized.
2025-01-11 19:41:55,856 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 19:41:55,856 - app_logger - INFO - Orchestrator initialized.
2025-01-11 19:41:55,856 - app_logger - INFO - Starting background tasks...
2025-01-11 19:41:55,856 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 19:41:55,899 - app_logger - INFO - Flask server running on port 5002.
2025-01-11 19:42:00,589 - app_logger - INFO - Received Dropbox event.
2025-01-11 19:42:00,589 - app_logger - INFO - Starting to process event data...
2025-01-11 19:42:00,591 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 19:42:00,767 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 19:42:00,770 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 19:42:00,771 - app_logger - INFO - Changes (1):
2025-01-11 19:42:00,771 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:42:00,771 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:42:00,772 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:42:00,772 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:42:00,773 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:42:01,790 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 19:42:02,649 - app_logger - DEBUG - ü§î Checking for PurchaseOrders with (project_number='2416', po_number='21').
2025-01-11 19:42:02,650 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 19:42:02,688 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 19:42:02,688 - app_logger - DEBUG - ü§ì Pulling record: 1448 from table purchase_order
2025-01-11 19:42:02,689 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 19:42:02,689 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 19:42:02,695 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 19:42:02,695 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:42:02,696 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 19:42:02,696 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=88), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 19:42:02,696 - app_logger - DEBUG - üîß Attempting to update Invoice(id=88). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 19:42:02,696 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}.
2025-01-11 19:42:02,699 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=88) updated.
2025-01-11 19:42:02,806 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 19:42:02,806 - app_logger - DEBUG - Created a new instance of DatabaseTriggerService.
2025-01-11 19:42:02,870 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 19:42:02,872 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:42:03,456 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 19:42:04,281 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 19:42:04,281 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 19:42:04,281 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=88), data={'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 19:42:04,281 - app_logger - DEBUG - üîß Attempting to update Invoice(id=88). Fields: {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 19:42:04,281 - app_logger - INFO - ü§ù Checking if Invoice(id=88) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 19:42:04,286 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=88) updated.
2025-01-11 19:42:04,290 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 19:42:04,292 - app_logger - DEBUG - ü§ì Pulling record: 88 from table invoice
2025-01-11 19:42:04,296 - app_logger - DEBUG - üîé search_detail_items: columns=['po_id', 'detail_number', 'payment_type'], values=[1448, 1, 'INV']
2025-01-11 19:42:04,296 - app_logger - DEBUG - üïµÔ∏è Searching DetailItem with filters: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 19:42:04,296 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 19:42:04,302 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 19:42:04,302 - app_logger - DEBUG - ü§ì Pulling record: 6222 from table detail_item
2025-01-11 19:42:04,302 - app_logger - DEBUG - ü§ì Pulling record: 6223 from table detail_item
2025-01-11 19:42:04,303 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:42:04,304 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 19:42:04,317 - app_logger - INFO - Received Dropbox event.
2025-01-11 19:42:04,317 - app_logger - INFO - Starting to process event data...
2025-01-11 19:42:04,317 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 19:42:04,450 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 19:42:04,452 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 19:42:04,453 - app_logger - INFO - Changes (0):
2025-01-11 19:42:04,454 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 19:43:31,341 - app_logger - INFO - Received Dropbox event.
2025-01-11 19:43:31,342 - app_logger - INFO - Starting to process event data...
2025-01-11 19:43:31,342 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 19:43:31,741 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 19:43:31,742 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 19:43:31,742 - app_logger - DEBUG - DELETE: DeletedMetadata(name='2416_21_01 Jordan Sakai Invoice.pdf', parent_shared_folder_id=NOT_SET, path_display='/2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf', path_lower='/2416 - whop keynote/1. purchase orders/2416_21 jordan sakai/2416_21_01 jordan sakai invoice.pdf', preview_url=NOT_SET)
2025-01-11 19:43:31,742 - app_logger - INFO - Changes (0):
2025-01-11 19:43:31,742 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 19:43:35,405 - app_logger - INFO - Received Dropbox event.
2025-01-11 19:43:35,405 - app_logger - INFO - Starting to process event data...
2025-01-11 19:43:35,405 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 19:43:35,561 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 19:43:35,565 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 19:43:35,565 - app_logger - INFO - Changes (1):
2025-01-11 19:43:35,566 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:43:35,566 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:43:35,567 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:43:35,567 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:43:35,567 - app_logger - INFO - ‚¨áÔ∏è Downloading invoice file to ./temp_files/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:43:36,119 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 19:43:40,447 - app_logger - DEBUG - ü§î Checking for PurchaseOrders with (project_number='2416', po_number='21').
2025-01-11 19:43:40,448 - app_logger - INFO - üö¶ Searching PurchaseOrders with project_number='2416', po_number='21'
2025-01-11 19:43:40,451 - app_logger - INFO - üéØ Exactly ONE PurchaseOrder matched.
2025-01-11 19:43:40,451 - app_logger - DEBUG - ü§ì Pulling record: 1448 from table purchase_order
2025-01-11 19:43:40,452 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 19:43:40,452 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 19:43:40,453 - app_logger - INFO - üôÖ No Invoices matched.
2025-01-11 19:43:40,454 - app_logger - INFO - üÜï Creating new invoice #1 for PO 21 (project 2416).
2025-01-11 19:43:40,454 - app_logger - DEBUG - üßæ create_invoice with {'project_number': 2416, 'po_number': 21, 'invoice_number': 1, 'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 19:43:40,454 - app_logger - DEBUG - üßë‚Äçüíª Creating new Invoice using data: {'project_number': 2416, 'po_number': 21, 'invoice_number': 1, 'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 19:43:40,454 - app_logger - INFO - üå± About to insert a fresh record into Invoice with {'project_number': 2416, 'po_number': 21, 'invoice_number': 1, 'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0}
2025-01-11 19:43:40,456 - app_logger - DEBUG - [INVOICE AFTER INSERT] Invoice(id=89) created.
2025-01-11 19:43:40,460 - app_logger - INFO - üéâ Creation successful! Record is now in the DB.
2025-01-11 19:43:40,462 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 19:43:41,125 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 19:43:41,931 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 19:43:41,931 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 19:43:41,932 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 19:43:41,932 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 19:43:41,932 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 19:43:41,940 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-11 19:43:41,949 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 19:43:41,951 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 19:43:41,954 - app_logger - DEBUG - üîé search_detail_items: columns=['po_id', 'detail_number', 'payment_type'], values=[1448, 1, 'INV']
2025-01-11 19:43:41,954 - app_logger - DEBUG - üïµÔ∏è Searching DetailItem with filters: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 19:43:41,954 - app_logger - INFO - üö¶ Checking if there are any matches in DetailItem for columns & values: [('po_id', 1448), ('detail_number', 1), ('payment_type', 'INV')]
2025-01-11 19:43:41,957 - app_logger - INFO - ‚úÖ Located 2 records! Bundling them all up.
2025-01-11 19:43:41,958 - app_logger - DEBUG - ü§ì Pulling record: 6222 from table detail_item
2025-01-11 19:43:41,958 - app_logger - DEBUG - ü§ì Pulling record: 6223 from table detail_item
2025-01-11 19:43:41,959 - app_logger - DEBUG - üîß update_detail_item_by_keys for project_number='2416', po_number='21', detail_number='1', line_id='1'. Extra={'invoice_id': 89}
2025-01-11 19:43:41,959 - app_logger - INFO - ü§ù Updating an existing DetailItem for project_number=2416, po_number=21, detail_number=1, line_id=1
2025-01-11 19:43:41,967 - app_logger - DEBUG - [DETAIL ITEM AFTER UPDATE] DetailItem(id=6222) updated.
2025-01-11 19:43:41,967 - app_logger - INFO - üîî Attempting to enqueue detail_item_update for ID=6222
2025-01-11 19:43:41,970 - app_logger - INFO - ‚úÖ The DetailItem has been updated successfully.
2025-01-11 19:43:41,974 - app_logger - DEBUG - ü§ì Pulling record: 6222 from table detail_item
2025-01-11 19:43:41,975 - app_logger - INFO - Linked invoice_id=89 to detail_item #1 (DB ID=6222).
2025-01-11 19:43:41,975 - app_logger - DEBUG - üîß update_detail_item_by_keys for project_number='2416', po_number='21', detail_number='1', line_id='2'. Extra={'invoice_id': 89}
2025-01-11 19:43:41,976 - app_logger - INFO - ü§ù Updating an existing DetailItem for project_number=2416, po_number=21, detail_number=1, line_id=2
2025-01-11 19:43:41,981 - app_logger - DEBUG - [DETAIL ITEM AFTER UPDATE] DetailItem(id=6223) updated.
2025-01-11 19:43:41,981 - app_logger - INFO - üîî Attempting to enqueue detail_item_update for ID=6223
2025-01-11 19:43:41,993 - app_logger - INFO - ‚úÖ The DetailItem has been updated successfully.
2025-01-11 19:43:41,995 - app_logger - DEBUG - ü§ì Pulling record: 6223 from table detail_item
2025-01-11 19:43:41,996 - app_logger - INFO - Linked invoice_id=89 to detail_item #1 (DB ID=6223).
2025-01-11 19:43:41,996 - app_logger - INFO - ‚úÖ Invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 19:43:41,997 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 20:07:38,319 - app_logger - INFO - Shutting down the application...
2025-01-11 20:07:39,005 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-11 20:07:39,005 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-11 20:07:39,005 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-11 20:07:39,005 - app_logger - INFO - Starting the application...
2025-01-11 20:07:39,481 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-11 20:07:39,481 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 20:07:39,481 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-11 20:07:39,887 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 20:07:41,151 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 20:07:41,172 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-11 20:07:41,558 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 20:07:42,379 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 20:07:42,379 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 20:07:42,380 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-11 20:07:43,045 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-11 20:07:43,764 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 20:07:43,764 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-11 20:07:43,765 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-11 20:07:43,765 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 20:07:43,765 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-11 20:07:43,801 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 20:07:43,801 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 20:07:43,801 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-11 20:07:43,801 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 20:07:43,801 - app_logger - INFO - Monday Service initialized
2025-01-11 20:07:43,801 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-11 20:07:43,802 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 20:07:43,802 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 20:07:43,802 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-11 20:07:43,802 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 20:07:43,802 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-11 20:07:43,841 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 20:07:43,841 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 20:07:43,846 - app_logger - INFO - OCR Service initialized
2025-01-11 20:07:43,846 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-11 20:07:43,846 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 20:07:43,846 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 20:07:43,847 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 20:07:43,847 - app_logger - DEBUG - Initialized XeroServices.
2025-01-11 20:07:43,847 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-11 20:07:43,913 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 20:07:43,913 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 20:07:43,913 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 20:07:43,913 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 20:07:43,913 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 20:07:43,913 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 20:07:43,913 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-11 20:07:43,915 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 20:07:43,915 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-11 20:07:43,916 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 20:07:43,922 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 20:07:43,945 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-11 20:07:43,946 - app_logger - INFO - Database initialized.
2025-01-11 20:07:43,946 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 20:07:43,946 - app_logger - INFO - Orchestrator initialized.
2025-01-11 20:07:43,946 - app_logger - INFO - Starting background tasks...
2025-01-11 20:07:43,946 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 20:07:44,010 - app_logger - INFO - Flask server running on port 5002.
2025-01-11 20:07:58,926 - app_logger - INFO - Received Dropbox event.
2025-01-11 20:07:58,926 - app_logger - INFO - Starting to process event data...
2025-01-11 20:07:58,927 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 20:07:59,099 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 20:07:59,103 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 20:07:59,103 - app_logger - INFO - Changes (1):
2025-01-11 20:07:59,103 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:07:59,103 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:07:59,104 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:07:59,104 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:07:59,833 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 20:08:00,969 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 20:08:00,970 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 20:08:01,493 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 20:08:02,418 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 20:08:02,418 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 20:08:02,453 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 20:08:02,454 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 20:08:02,454 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 20:08:02,454 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 20:08:02,455 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 20:08:02,455 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 20:08:02,458 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-11 20:08:02,564 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 20:08:02,564 - app_logger - DEBUG - Created a new instance of DatabaseTriggerService.
2025-01-11 20:08:02,627 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 20:08:02,629 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 20:08:02,630 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:08:02,630 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 20:08:02,642 - app_logger - INFO - Received Dropbox event.
2025-01-11 20:08:02,642 - app_logger - INFO - Starting to process event data...
2025-01-11 20:08:02,642 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 20:08:02,822 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 20:08:02,822 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 20:08:02,822 - app_logger - INFO - Changes (0):
2025-01-11 20:08:02,823 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 20:40:31,742 - app_logger - INFO - Received Dropbox event.
2025-01-11 20:40:31,743 - app_logger - INFO - Starting to process event data...
2025-01-11 20:40:31,745 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 20:40:32,797 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 20:40:32,797 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 20:40:32,797 - app_logger - INFO - Changes (1):
2025-01-11 20:40:32,798 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:40:32,798 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:40:32,798 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:40:32,798 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:40:33,441 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 20:40:34,755 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 20:40:34,756 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 20:40:35,530 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 20:40:36,411 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 20:40:36,412 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 20:40:36,422 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 20:40:36,423 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 20:40:36,425 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 20:40:36,425 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 20:40:36,426 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 20:40:36,426 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 20:40:36,435 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-11 20:40:36,440 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 20:40:36,443 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 20:40:36,445 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:40:36,447 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 20:40:36,461 - app_logger - INFO - Received Dropbox event.
2025-01-11 20:40:36,461 - app_logger - INFO - Starting to process event data...
2025-01-11 20:40:36,461 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 20:40:36,624 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 20:40:36,625 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 20:40:36,626 - app_logger - INFO - Changes (0):
2025-01-11 20:40:36,627 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 20:52:45,159 - app_logger - INFO - Received Dropbox event.
2025-01-11 20:52:45,160 - app_logger - INFO - Starting to process event data...
2025-01-11 20:52:45,160 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 20:52:45,675 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 20:52:45,677 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 20:52:45,677 - app_logger - INFO - Changes (1):
2025-01-11 20:52:45,677 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:52:45,677 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:52:45,677 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:52:45,678 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:52:46,417 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 20:52:47,240 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 20:52:47,240 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 20:52:47,762 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 20:52:48,690 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 20:52:48,690 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 20:52:48,697 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 20:52:48,698 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 20:52:48,699 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 20:52:48,699 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 20:52:48,699 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 20:52:48,699 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 20:52:48,702 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-11 20:52:48,708 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 20:52:48,710 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 20:52:48,711 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:52:48,713 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 20:52:48,726 - app_logger - INFO - Received Dropbox event.
2025-01-11 20:52:48,726 - app_logger - INFO - Starting to process event data...
2025-01-11 20:52:48,726 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 20:52:48,887 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 20:52:48,890 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 20:52:48,891 - app_logger - INFO - Changes (0):
2025-01-11 20:52:48,892 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 20:56:47,590 - app_logger - INFO - Received Dropbox event.
2025-01-11 20:56:47,591 - app_logger - INFO - Starting to process event data...
2025-01-11 20:56:47,592 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 20:56:47,896 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 20:56:47,902 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 20:56:47,905 - app_logger - INFO - Changes (1):
2025-01-11 20:56:47,905 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:56:47,905 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:56:47,906 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:56:47,906 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:56:48,572 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 20:56:50,023 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 20:56:50,025 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 20:56:51,283 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 20:56:52,251 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 20:56:52,251 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 20:56:52,253 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 20:56:52,254 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 20:56:52,254 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 20:56:52,254 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 20:56:52,254 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 20:56:52,254 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 20:56:52,256 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-11 20:56:52,258 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 20:56:52,260 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 20:56:52,260 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 20:56:52,261 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 20:56:52,273 - app_logger - INFO - Received Dropbox event.
2025-01-11 20:56:52,273 - app_logger - INFO - Starting to process event data...
2025-01-11 20:56:52,274 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 20:56:52,417 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 20:56:52,417 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 20:56:52,418 - app_logger - INFO - Changes (0):
2025-01-11 20:56:52,418 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 21:06:07,804 - app_logger - INFO - Shutting down the application...
2025-01-11 21:06:12,245 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-11 21:06:12,245 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-11 21:06:12,245 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-11 21:06:12,246 - app_logger - INFO - Starting the application...
2025-01-11 21:06:12,414 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-11 21:06:12,414 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 21:06:12,414 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-11 21:06:12,619 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 21:06:13,436 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 21:06:13,441 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-11 21:06:13,618 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 21:06:14,280 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 21:06:14,281 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 21:06:14,281 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-11 21:06:14,778 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-11 21:06:15,076 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 21:06:15,077 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-11 21:06:15,077 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-11 21:06:15,078 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 21:06:15,078 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-11 21:06:15,105 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 21:06:15,105 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:06:15,105 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-11 21:06:15,106 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:06:15,106 - app_logger - INFO - Monday Service initialized
2025-01-11 21:06:15,106 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-11 21:06:15,106 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 21:06:15,106 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:06:15,106 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-11 21:06:15,107 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 21:06:15,107 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-11 21:06:15,164 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 21:06:15,164 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:06:15,168 - app_logger - INFO - OCR Service initialized
2025-01-11 21:06:15,168 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-11 21:06:15,168 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 21:06:15,168 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 21:06:15,169 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:06:15,169 - app_logger - DEBUG - Initialized XeroServices.
2025-01-11 21:06:15,169 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-11 21:06:15,196 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 21:06:15,196 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:06:15,196 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 21:06:15,196 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 21:06:15,196 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 21:06:15,196 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 21:06:15,196 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-11 21:06:15,196 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 21:06:15,196 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-11 21:06:15,197 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 21:06:15,200 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 21:06:15,213 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-11 21:06:15,213 - app_logger - INFO - Database initialized.
2025-01-11 21:06:15,213 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 21:06:15,213 - app_logger - INFO - Orchestrator initialized.
2025-01-11 21:06:15,213 - app_logger - INFO - Starting background tasks...
2025-01-11 21:06:15,213 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 21:06:15,251 - app_logger - INFO - Flask server running on port 5002.
2025-01-11 21:06:36,993 - app_logger - INFO - Received Dropbox event.
2025-01-11 21:06:36,993 - app_logger - INFO - Starting to process event data...
2025-01-11 21:06:36,995 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 21:06:37,226 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 21:06:37,227 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 21:06:37,227 - app_logger - INFO - Changes (1):
2025-01-11 21:06:37,227 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:06:37,227 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:06:37,228 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:06:37,228 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:06:37,789 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 21:06:38,810 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 21:06:38,810 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 21:06:39,298 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 21:06:40,061 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 21:06:40,061 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 21:06:40,082 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 21:06:40,082 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 21:06:40,082 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 21:06:40,082 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 21:06:40,082 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 21:06:40,082 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 21:06:40,085 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-11 21:06:40,122 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:06:40,122 - app_logger - DEBUG - Created a new instance of DatabaseTriggerService.
2025-01-11 21:06:40,163 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 21:06:40,165 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 21:06:40,168 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:06:40,168 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 21:06:40,180 - app_logger - INFO - Received Dropbox event.
2025-01-11 21:06:40,180 - app_logger - INFO - Starting to process event data...
2025-01-11 21:06:40,180 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 21:06:40,328 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 21:06:40,329 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 21:06:40,329 - app_logger - INFO - Changes (0):
2025-01-11 21:06:40,329 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 21:07:27,982 - app_logger - INFO - Received Dropbox event.
2025-01-11 21:07:27,982 - app_logger - INFO - Starting to process event data...
2025-01-11 21:07:27,982 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 21:07:28,157 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 21:07:28,159 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 21:07:28,159 - app_logger - INFO - Changes (1):
2025-01-11 21:07:28,159 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:07:28,160 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:07:28,160 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:07:28,160 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:07:28,844 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 21:07:29,830 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 21:07:29,831 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 21:07:30,214 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 21:07:30,852 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 21:07:30,853 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 21:07:30,860 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 21:07:30,861 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 21:07:30,863 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 21:07:30,863 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 21:07:30,863 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 21:07:30,863 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 21:07:30,867 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-11 21:07:30,873 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 21:07:30,876 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 21:07:30,877 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:07:30,878 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 21:07:30,892 - app_logger - INFO - Received Dropbox event.
2025-01-11 21:07:30,892 - app_logger - INFO - Starting to process event data...
2025-01-11 21:07:30,893 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 21:07:31,463 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 21:07:31,466 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 21:07:31,466 - app_logger - INFO - Changes (0):
2025-01-11 21:07:31,467 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 21:08:05,358 - app_logger - INFO - Received Dropbox event.
2025-01-11 21:08:05,358 - app_logger - INFO - Starting to process event data...
2025-01-11 21:08:05,359 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 21:08:05,530 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 21:08:05,533 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 21:08:05,534 - app_logger - INFO - Changes (1):
2025-01-11 21:08:05,534 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:08:05,535 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:08:05,535 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:08:05,535 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:08:06,095 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 21:08:06,915 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 21:08:06,915 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 21:08:07,201 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 21:08:07,986 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 21:08:07,987 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 21:08:07,995 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 21:08:07,996 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 21:08:07,998 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 21:08:07,998 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 21:08:07,998 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 21:08:07,998 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 21:08:08,003 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-11 21:08:08,014 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 21:08:08,018 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 21:08:08,021 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:08:08,024 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 21:08:08,040 - app_logger - INFO - Received Dropbox event.
2025-01-11 21:08:08,043 - app_logger - INFO - Starting to process event data...
2025-01-11 21:08:08,044 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 21:08:08,209 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 21:08:08,211 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 21:08:08,211 - app_logger - INFO - Changes (0):
2025-01-11 21:08:08,212 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 21:09:29,195 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-11 21:09:29,195 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-11 21:09:29,195 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-11 21:09:29,195 - app_logger - INFO - Starting the application...
2025-01-11 21:09:29,358 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-11 21:09:29,358 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 21:09:29,358 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-11 21:09:29,545 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 21:09:30,351 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 21:09:30,354 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-11 21:09:30,517 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 21:09:31,469 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 21:09:31,469 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 21:09:31,470 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-11 21:09:31,889 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-11 21:09:32,288 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 21:09:32,288 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-11 21:09:32,289 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-11 21:09:32,289 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 21:09:32,289 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-11 21:09:32,303 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 21:09:32,303 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:09:32,303 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-11 21:09:32,303 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:09:32,303 - app_logger - INFO - Monday Service initialized
2025-01-11 21:09:32,303 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-11 21:09:32,303 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 21:09:32,303 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:09:32,303 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-11 21:09:32,304 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 21:09:32,304 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-11 21:09:32,325 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 21:09:32,325 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:09:32,329 - app_logger - INFO - OCR Service initialized
2025-01-11 21:09:32,329 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-11 21:09:32,329 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 21:09:32,329 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 21:09:32,330 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:09:32,330 - app_logger - DEBUG - Initialized XeroServices.
2025-01-11 21:09:32,330 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-11 21:09:32,387 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 21:09:32,387 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:09:32,387 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 21:09:32,387 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 21:09:32,387 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 21:09:32,387 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 21:09:32,387 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-11 21:09:32,388 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 21:09:32,388 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-11 21:09:32,388 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 21:09:32,390 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 21:09:32,402 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-11 21:09:32,402 - app_logger - INFO - Database initialized.
2025-01-11 21:09:32,402 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 21:09:32,402 - app_logger - INFO - Orchestrator initialized.
2025-01-11 21:09:32,402 - app_logger - INFO - Starting background tasks...
2025-01-11 21:09:32,403 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 21:09:32,441 - app_logger - INFO - Flask server running on port 5002.
2025-01-11 21:09:36,179 - app_logger - INFO - Shutting down the application...
2025-01-11 21:09:42,836 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-11 21:09:42,836 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-11 21:09:42,836 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-11 21:09:42,836 - app_logger - INFO - Starting the application...
2025-01-11 21:09:43,006 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-11 21:09:43,006 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-11 21:09:43,006 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-11 21:09:43,006 - app_logger - INFO - Starting the application...
2025-01-11 21:09:43,158 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-11 21:09:43,158 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-11 21:09:43,158 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-11 21:09:43,343 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 21:09:43,956 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 21:09:43,959 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-11 21:09:44,123 - app_logger - INFO - Dropbox Client Initialized
2025-01-11 21:09:44,791 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-11 21:09:44,791 - app_logger - INFO - Dropbox Util  initialized
2025-01-11 21:09:44,791 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-11 21:09:45,309 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-11 21:09:45,850 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-11 21:09:45,851 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-11 21:09:45,851 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-11 21:09:45,851 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-11 21:09:45,851 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-11 21:09:45,876 - app_logger - INFO - Monday Database Utility initialized
2025-01-11 21:09:45,876 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:09:45,876 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-11 21:09:45,876 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:09:45,876 - app_logger - INFO - Monday Service initialized
2025-01-11 21:09:45,876 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-11 21:09:45,877 - app_logger - INFO - PO Log Database Util initialized
2025-01-11 21:09:45,877 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:09:45,877 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-11 21:09:45,877 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-11 21:09:45,877 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-11 21:09:45,904 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 21:09:45,905 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:09:45,909 - app_logger - INFO - OCR Service initialized
2025-01-11 21:09:45,909 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-11 21:09:45,909 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 21:09:45,909 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 21:09:45,910 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:09:45,910 - app_logger - DEBUG - Initialized XeroServices.
2025-01-11 21:09:45,910 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-11 21:09:45,969 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-11 21:09:45,969 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:09:45,969 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 21:09:45,969 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-11 21:09:45,976 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-11 21:09:45,976 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-11 21:09:45,976 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-11 21:09:45,976 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-11 21:09:45,977 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-11 21:09:45,977 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 21:09:45,983 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-11 21:09:45,998 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-11 21:09:45,998 - app_logger - INFO - Database initialized.
2025-01-11 21:09:45,998 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-11 21:09:45,998 - app_logger - INFO - Orchestrator initialized.
2025-01-11 21:09:45,998 - app_logger - INFO - Starting background tasks...
2025-01-11 21:09:45,998 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-11 21:09:46,001 - app_logger - INFO - Flask server running on port 5002.
2025-01-11 21:09:58,231 - app_logger - INFO - Received Dropbox event.
2025-01-11 21:09:58,232 - app_logger - INFO - Starting to process event data...
2025-01-11 21:09:58,234 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 21:09:58,400 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 21:09:58,403 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 21:09:58,404 - app_logger - INFO - Changes (1):
2025-01-11 21:09:58,404 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:09:58,404 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:09:58,404 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:09:58,405 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:09:59,025 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 21:09:59,947 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 21:09:59,948 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 21:10:00,445 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 21:10:01,294 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 21:10:01,295 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 21:10:01,312 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 21:10:01,312 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 21:10:01,313 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 21:10:01,313 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 21:10:01,313 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 21:10:01,313 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 21:10:01,316 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-11 21:10:01,357 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-11 21:10:01,357 - app_logger - DEBUG - Created a new instance of DatabaseTriggerService.
2025-01-11 21:10:01,396 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 21:10:01,397 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 21:10:01,397 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:10:01,398 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 21:10:01,410 - app_logger - INFO - Received Dropbox event.
2025-01-11 21:10:01,410 - app_logger - INFO - Starting to process event data...
2025-01-11 21:10:01,410 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 21:10:01,552 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 21:10:01,553 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 21:10:01,553 - app_logger - INFO - Changes (0):
2025-01-11 21:10:01,553 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 21:35:58,461 - app_logger - INFO - Received Dropbox event.
2025-01-11 21:35:58,462 - app_logger - INFO - Starting to process event data...
2025-01-11 21:35:58,463 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 21:35:58,689 - app_logger - DEBUG - Fetched 1 changes.
2025-01-11 21:35:58,690 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 21:35:58,690 - app_logger - INFO - Changes (1):
2025-01-11 21:35:58,691 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:35:58,691 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:35:58,691 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:35:58,692 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:35:59,306 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-11 21:35:59,987 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 21:35:59,988 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-11 21:36:00,489 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-11 21:36:01,207 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-11 21:36:01,208 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-11 21:36:01,212 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-11 21:36:01,212 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 21:36:01,214 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-11 21:36:01,214 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 21:36:01,214 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-11 21:36:01,214 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-11 21:36:01,217 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-11 21:36:01,221 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-11 21:36:01,223 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-11 21:36:01,224 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-11 21:36:01,227 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-11 21:36:01,243 - app_logger - INFO - Received Dropbox event.
2025-01-11 21:36:01,243 - app_logger - INFO - Starting to process event data...
2025-01-11 21:36:01,243 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-11 21:36:01,753 - app_logger - DEBUG - Fetched 0 changes.
2025-01-11 21:36:01,755 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-11 21:36:01,756 - app_logger - INFO - Changes (0):
2025-01-11 21:36:01,757 - app_logger - DEBUG - Cursor successfully updated in the finally block.
