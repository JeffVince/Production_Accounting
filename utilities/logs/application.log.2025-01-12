2025-01-12 04:13:32,833 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:13:32,859 - app_logger - INFO - Starting to process event data...
2025-01-12 04:13:32,860 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:13:33,282 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 04:13:33,287 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:13:33,292 - app_logger - INFO - Changes (1):
2025-01-12 04:13:33,292 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:13:33,292 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:13:33,293 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:13:33,293 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:13:34,091 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 04:13:34,885 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:13:34,888 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:13:35,656 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 04:13:36,323 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 04:13:36,323 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 04:13:36,325 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 04:13:36,325 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:13:36,325 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 04:13:36,325 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:13:36,325 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:13:36,325 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 04:13:36,326 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 04:13:36,327 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 04:13:36,328 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:13:36,328 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:13:36,329 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:13:36,341 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:13:36,341 - app_logger - INFO - Starting to process event data...
2025-01-12 04:13:36,341 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:13:36,486 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 04:13:36,486 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:13:36,486 - app_logger - INFO - Changes (0):
2025-01-12 04:13:36,486 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:16:23,165 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:16:23,165 - app_logger - INFO - Starting to process event data...
2025-01-12 04:16:23,166 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:16:24,288 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 04:16:24,293 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:16:24,294 - app_logger - INFO - Changes (1):
2025-01-12 04:16:24,294 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:16:24,294 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:16:24,295 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:16:24,295 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:16:25,003 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 04:16:26,032 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:16:26,033 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:16:26,591 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 04:16:27,275 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 04:16:27,276 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 04:16:27,281 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 04:16:27,281 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:16:27,282 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 04:16:27,282 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:16:27,282 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:16:27,282 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 04:16:27,284 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 04:16:27,288 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 04:16:27,291 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:16:27,296 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:16:27,299 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:16:27,317 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:16:27,318 - app_logger - INFO - Starting to process event data...
2025-01-12 04:16:27,318 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:16:27,462 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 04:16:27,463 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:16:27,463 - app_logger - INFO - Changes (0):
2025-01-12 04:16:27,464 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:16:43,659 - app_logger - INFO - Shutting down the application...
2025-01-12 04:16:52,203 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-12 04:16:52,203 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-12 04:16:52,203 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-12 04:16:52,203 - app_logger - INFO - Starting the application...
2025-01-12 04:16:52,389 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-12 04:16:52,390 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-12 04:16:52,390 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-12 04:16:52,642 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 04:16:53,680 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 04:16:53,684 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-12 04:16:53,913 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 04:16:54,555 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 04:16:54,556 - app_logger - INFO - Dropbox Util  initialized
2025-01-12 04:16:54,556 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-12 04:16:55,086 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-12 04:16:55,387 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-12 04:16:55,388 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-12 04:16:55,389 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-12 04:16:55,389 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-12 04:16:55,389 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-12 04:16:55,430 - app_logger - INFO - Monday Database Utility initialized
2025-01-12 04:16:55,430 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:16:55,430 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-12 04:16:55,430 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:16:55,430 - app_logger - INFO - Monday Service initialized
2025-01-12 04:16:55,430 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-12 04:16:55,431 - app_logger - INFO - PO Log Database Util initialized
2025-01-12 04:16:55,431 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:16:55,431 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-12 04:16:55,432 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-12 04:16:55,432 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-12 04:16:55,465 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 04:16:55,465 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:16:55,470 - app_logger - INFO - OCR Service initialized
2025-01-12 04:16:55,470 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-12 04:16:55,470 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 04:16:55,470 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 04:16:55,471 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:16:55,471 - app_logger - DEBUG - Initialized XeroServices.
2025-01-12 04:16:55,471 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-12 04:16:55,546 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 04:16:55,546 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:16:55,546 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 04:16:55,546 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 04:16:55,546 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 04:16:55,546 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-12 04:16:55,546 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-12 04:16:55,547 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-12 04:16:55,547 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-12 04:16:55,547 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 04:16:55,549 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-12 04:16:55,564 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-12 04:16:55,564 - app_logger - INFO - Database initialized.
2025-01-12 04:16:55,564 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 04:16:55,564 - app_logger - INFO - Orchestrator initialized.
2025-01-12 04:16:55,564 - app_logger - INFO - Starting background tasks...
2025-01-12 04:16:55,564 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-12 04:16:55,603 - app_logger - INFO - Flask server running on port 5002.
2025-01-12 04:17:14,309 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:17:14,310 - app_logger - INFO - Starting to process event data...
2025-01-12 04:17:14,311 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:17:14,666 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 04:17:14,670 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:17:14,670 - app_logger - INFO - Changes (1):
2025-01-12 04:17:14,671 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:17:14,671 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:17:14,671 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:17:14,672 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:17:15,281 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 04:17:16,068 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:17:16,069 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:17:16,561 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 04:17:17,354 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 04:17:17,355 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 04:17:17,380 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 04:17:17,380 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:17:17,381 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 04:17:17,381 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:17:17,381 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:17:17,381 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 04:17:17,383 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 04:17:17,428 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:17:17,428 - app_logger - DEBUG - Created a new instance of DatabaseTriggerService.
2025-01-12 04:17:17,463 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 04:17:17,467 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:17:17,467 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:17:17,468 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:17:17,480 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:17:17,480 - app_logger - INFO - Starting to process event data...
2025-01-12 04:17:17,480 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:17:17,628 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 04:17:17,628 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:17:17,628 - app_logger - INFO - Changes (0):
2025-01-12 04:17:17,629 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:17:42,317 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:17:42,318 - app_logger - INFO - Starting to process event data...
2025-01-12 04:17:42,319 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:17:42,513 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 04:17:42,518 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:17:42,519 - app_logger - INFO - Changes (1):
2025-01-12 04:17:42,519 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:17:42,519 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:17:42,519 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:17:42,519 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:17:43,134 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 04:17:43,920 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:17:43,921 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:17:44,410 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 04:17:45,190 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 04:17:45,191 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 04:17:45,204 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 04:17:45,206 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:17:45,210 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 04:17:45,210 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:17:45,210 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:17:45,210 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 04:17:45,213 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 04:17:45,215 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 04:17:45,216 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:17:45,217 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:17:45,219 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:17:45,231 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:17:45,231 - app_logger - INFO - Starting to process event data...
2025-01-12 04:17:45,231 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:17:45,399 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 04:17:45,400 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:17:45,401 - app_logger - INFO - Changes (0):
2025-01-12 04:17:45,401 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:18:58,209 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:18:58,210 - app_logger - INFO - Starting to process event data...
2025-01-12 04:18:58,210 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:18:58,385 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 04:18:58,387 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:18:58,388 - app_logger - INFO - Changes (1):
2025-01-12 04:18:58,388 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:18:58,388 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:18:58,388 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:18:58,389 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:18:59,013 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 04:19:00,117 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:19:00,117 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:19:00,446 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 04:19:01,113 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 04:19:01,113 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 04:19:01,117 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 04:19:01,117 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:19:01,119 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 04:19:01,119 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:19:01,119 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:19:01,120 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 04:19:01,123 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 04:19:01,126 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 04:19:01,129 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:19:01,130 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:19:01,131 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:19:01,238 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:19:01,238 - app_logger - INFO - Starting to process event data...
2025-01-12 04:19:01,239 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:19:01,425 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 04:19:01,425 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:19:01,425 - app_logger - INFO - Changes (0):
2025-01-12 04:19:01,425 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:21:54,935 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:21:54,936 - app_logger - INFO - Starting to process event data...
2025-01-12 04:21:54,936 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:21:55,196 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 04:21:55,197 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:21:55,197 - app_logger - INFO - Changes (1):
2025-01-12 04:21:55,197 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:21:55,197 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:21:55,197 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:21:55,197 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:21:55,853 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 04:21:56,616 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:21:56,616 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:21:57,170 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 04:21:57,907 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 04:21:57,908 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 04:21:57,913 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 04:21:57,913 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:21:57,914 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 04:21:57,914 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:21:57,914 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:21:57,914 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 04:21:57,916 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 04:21:57,921 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 04:21:57,923 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:21:57,925 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:21:57,926 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:21:57,938 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:21:57,939 - app_logger - INFO - Starting to process event data...
2025-01-12 04:21:57,939 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:21:58,090 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 04:21:58,092 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:21:58,093 - app_logger - INFO - Changes (0):
2025-01-12 04:21:58,094 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:22:16,921 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:22:16,922 - app_logger - INFO - Starting to process event data...
2025-01-12 04:22:16,923 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:22:17,138 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 04:22:17,139 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:22:17,139 - app_logger - INFO - Changes (1):
2025-01-12 04:22:17,140 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:22:17,140 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:22:17,140 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:22:17,140 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:22:17,954 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 04:22:18,662 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:22:18,663 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:22:19,035 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 04:22:19,682 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 04:22:19,682 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 04:22:19,692 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 04:22:19,693 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:22:19,695 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 04:22:19,696 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:22:19,696 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:22:19,696 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 04:22:19,701 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 04:22:19,709 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 04:22:19,712 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:22:19,715 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:22:19,718 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:22:19,733 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:22:19,734 - app_logger - INFO - Starting to process event data...
2025-01-12 04:22:19,734 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:22:19,876 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 04:22:19,877 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:22:19,877 - app_logger - INFO - Changes (0):
2025-01-12 04:22:19,878 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:23:13,787 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:23:13,788 - app_logger - INFO - Starting to process event data...
2025-01-12 04:23:13,789 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:23:14,022 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 04:23:14,023 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:23:14,023 - app_logger - INFO - Changes (1):
2025-01-12 04:23:14,024 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:23:14,024 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:23:14,024 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:23:14,024 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:23:14,555 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 04:23:15,592 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:23:15,594 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:23:16,148 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 04:23:16,878 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 04:23:16,879 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 04:23:16,902 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 04:23:16,903 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:23:16,908 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 04:23:16,909 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:23:16,909 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:23:16,909 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 04:23:16,914 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 04:23:16,921 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 04:23:16,923 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:23:16,926 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:23:16,927 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:23:16,939 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:23:16,940 - app_logger - INFO - Starting to process event data...
2025-01-12 04:23:16,940 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:23:17,211 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 04:23:17,212 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:23:17,212 - app_logger - INFO - Changes (0):
2025-01-12 04:23:17,213 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:23:57,819 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:23:57,819 - app_logger - INFO - Starting to process event data...
2025-01-12 04:23:57,820 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:23:58,003 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 04:23:58,004 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:23:58,004 - app_logger - INFO - Changes (1):
2025-01-12 04:23:58,004 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:23:58,004 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:23:58,004 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:23:58,004 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:23:58,556 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 04:23:59,337 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:23:59,338 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:23:59,720 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 04:24:00,400 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 04:24:00,401 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 04:24:00,405 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 04:24:00,405 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:24:00,406 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 04:24:00,406 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:24:00,406 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:24:00,406 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 04:24:00,407 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 04:24:00,409 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 04:24:00,412 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:24:00,417 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:24:00,418 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:24:00,430 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:24:00,430 - app_logger - INFO - Starting to process event data...
2025-01-12 04:24:00,430 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:24:00,585 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 04:24:00,586 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:24:00,586 - app_logger - INFO - Changes (0):
2025-01-12 04:24:00,586 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:25:46,060 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:25:46,061 - app_logger - INFO - Starting to process event data...
2025-01-12 04:25:46,063 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:25:46,429 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 04:25:46,430 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:25:46,430 - app_logger - INFO - Changes (1):
2025-01-12 04:25:46,430 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:25:46,430 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:25:46,431 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:25:46,431 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:25:47,009 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 04:25:48,103 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:25:48,104 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:25:48,622 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 04:25:49,330 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 04:25:49,330 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 04:25:49,334 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 04:25:49,334 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:25:49,334 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 04:25:49,334 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:25:49,334 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:25:49,334 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 04:25:49,336 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 04:25:49,337 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 04:25:49,338 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:25:49,339 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:25:49,340 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:25:49,352 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:25:49,352 - app_logger - INFO - Starting to process event data...
2025-01-12 04:25:49,352 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:25:49,488 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 04:25:49,488 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:25:49,488 - app_logger - INFO - Changes (0):
2025-01-12 04:25:49,488 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:34:38,903 - app_logger - INFO - Shutting down the application...
2025-01-12 04:34:39,432 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-12 04:34:39,432 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-12 04:34:39,432 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-12 04:34:39,432 - app_logger - INFO - Starting the application...
2025-01-12 04:34:39,708 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-12 04:34:39,709 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-12 04:34:39,709 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-12 04:34:40,054 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 04:34:40,856 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 04:34:40,874 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-12 04:34:41,263 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 04:34:42,230 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 04:34:42,231 - app_logger - INFO - Dropbox Util  initialized
2025-01-12 04:34:42,231 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-12 04:34:42,835 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-12 04:34:43,119 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-12 04:34:43,119 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-12 04:34:43,120 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-12 04:34:43,121 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-12 04:34:43,121 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-12 04:34:43,168 - app_logger - INFO - Monday Database Utility initialized
2025-01-12 04:34:43,168 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:34:43,168 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-12 04:34:43,168 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:34:43,168 - app_logger - INFO - Monday Service initialized
2025-01-12 04:34:43,168 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-12 04:34:43,169 - app_logger - INFO - PO Log Database Util initialized
2025-01-12 04:34:43,169 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:34:43,169 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-12 04:34:43,170 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-12 04:34:43,170 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-12 04:34:43,210 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 04:34:43,210 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:34:43,215 - app_logger - INFO - OCR Service initialized
2025-01-12 04:34:43,215 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-12 04:34:43,215 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 04:34:43,215 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 04:34:43,216 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:34:43,216 - app_logger - DEBUG - Initialized XeroServices.
2025-01-12 04:34:43,216 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-12 04:34:43,277 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 04:34:43,277 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:34:43,277 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 04:34:43,277 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 04:34:43,277 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 04:34:43,278 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-12 04:34:43,278 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-12 04:34:43,278 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-12 04:34:43,278 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-12 04:34:43,279 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 04:34:43,287 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-12 04:34:43,308 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-12 04:34:43,308 - app_logger - INFO - Database initialized.
2025-01-12 04:34:43,308 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 04:34:43,308 - app_logger - INFO - Orchestrator initialized.
2025-01-12 04:34:43,308 - app_logger - INFO - Starting background tasks...
2025-01-12 04:34:43,309 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-12 04:34:43,345 - app_logger - INFO - Flask server running on port 5002.
2025-01-12 04:34:43,628 - app_logger - INFO - Shutting down the application...
2025-01-12 04:34:45,870 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-12 04:34:45,870 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-12 04:34:45,870 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-12 04:34:45,870 - app_logger - INFO - Starting the application...
2025-01-12 04:34:46,030 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-12 04:34:46,030 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-12 04:34:46,030 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-12 04:34:46,227 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 04:34:46,893 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 04:34:46,896 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-12 04:34:47,052 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 04:34:47,855 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 04:34:47,856 - app_logger - INFO - Dropbox Util  initialized
2025-01-12 04:34:47,856 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-12 04:34:48,195 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-12 04:34:48,460 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-12 04:34:48,460 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-12 04:34:48,461 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-12 04:34:48,461 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-12 04:34:48,462 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-12 04:34:48,488 - app_logger - INFO - Monday Database Utility initialized
2025-01-12 04:34:48,488 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:34:48,488 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-12 04:34:48,488 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:34:48,488 - app_logger - INFO - Monday Service initialized
2025-01-12 04:34:48,489 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-12 04:34:48,489 - app_logger - INFO - PO Log Database Util initialized
2025-01-12 04:34:48,489 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:34:48,489 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-12 04:34:48,489 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-12 04:34:48,490 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-12 04:34:48,516 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 04:34:48,516 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:34:48,521 - app_logger - INFO - OCR Service initialized
2025-01-12 04:34:48,521 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-12 04:34:48,521 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 04:34:48,521 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 04:34:48,521 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:34:48,521 - app_logger - DEBUG - Initialized XeroServices.
2025-01-12 04:34:48,521 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-12 04:34:48,581 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 04:34:48,581 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:34:48,581 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 04:34:48,581 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 04:34:48,581 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 04:34:48,581 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-12 04:34:48,581 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-12 04:34:48,581 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-12 04:34:48,581 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-12 04:34:48,582 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 04:34:48,586 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-12 04:34:48,599 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-12 04:34:48,599 - app_logger - INFO - Database initialized.
2025-01-12 04:34:48,599 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 04:34:48,599 - app_logger - INFO - Orchestrator initialized.
2025-01-12 04:34:48,599 - app_logger - INFO - Starting background tasks...
2025-01-12 04:34:48,599 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-12 04:34:48,602 - app_logger - INFO - Flask server running on port 5002.
2025-01-12 04:35:02,289 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:35:02,290 - app_logger - INFO - Starting to process event data...
2025-01-12 04:35:02,290 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:35:02,509 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 04:35:02,520 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:35:02,520 - app_logger - INFO - Changes (1):
2025-01-12 04:35:02,520 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:35:02,521 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:35:02,521 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:35:02,521 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:35:03,117 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 04:35:04,140 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:35:04,141 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:35:04,798 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 04:35:05,619 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 04:35:05,620 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 04:35:05,650 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 04:35:05,650 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:35:05,651 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 04:35:05,651 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:35:05,651 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:35:05,651 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 04:35:05,654 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 04:35:05,697 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:35:05,697 - app_logger - DEBUG - Created a new instance of DatabaseTriggerService.
2025-01-12 04:35:05,698 - app_logger - DEBUG - Preparing to enqueue invoice_update for invoice_id=89
2025-01-12 04:35:05,728 - app_logger - INFO - Successfully enqueued invoice_update for invoice_id=89
2025-01-12 04:35:05,729 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 04:35:05,731 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:35:05,731 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:35:05,732 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:35:05,743 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:35:05,743 - app_logger - INFO - Starting to process event data...
2025-01-12 04:35:05,744 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:35:05,875 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 04:35:05,875 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:35:05,875 - app_logger - INFO - Changes (0):
2025-01-12 04:35:05,876 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:38:55,905 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:38:55,905 - app_logger - INFO - Starting to process event data...
2025-01-12 04:38:55,905 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:38:56,158 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 04:38:56,158 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:38:56,158 - app_logger - INFO - Changes (1):
2025-01-12 04:38:56,158 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:38:56,158 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:38:56,159 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:38:56,159 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:38:56,755 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 04:38:57,466 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:38:57,466 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:38:58,002 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 04:38:58,669 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 04:38:58,669 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 04:38:58,671 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 04:38:58,671 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:38:58,672 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 04:38:58,672 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:38:58,672 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:38:58,672 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 04:38:58,674 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 04:38:58,674 - app_logger - DEBUG - Preparing to enqueue invoice_update for invoice_id=89
2025-01-12 04:38:58,675 - app_logger - INFO - Successfully enqueued invoice_update for invoice_id=89
2025-01-12 04:38:58,676 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 04:38:58,677 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:38:58,679 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:38:58,679 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:38:58,691 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:38:58,691 - app_logger - INFO - Starting to process event data...
2025-01-12 04:38:58,691 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:38:58,834 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 04:38:58,835 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:38:58,835 - app_logger - INFO - Changes (0):
2025-01-12 04:38:58,835 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:39:14,921 - app_logger - INFO - Shutting down the application...
2025-01-12 04:39:16,565 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-12 04:39:16,565 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-12 04:39:16,565 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-12 04:39:16,565 - app_logger - INFO - Starting the application...
2025-01-12 04:39:16,717 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-12 04:39:16,717 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-12 04:39:16,717 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-12 04:39:16,906 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 04:39:17,579 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 04:39:17,583 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-12 04:39:17,745 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 04:39:18,434 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 04:39:18,434 - app_logger - INFO - Dropbox Util  initialized
2025-01-12 04:39:18,434 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-12 04:39:18,740 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-12 04:39:19,019 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-12 04:39:19,019 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-12 04:39:19,019 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-12 04:39:19,019 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-12 04:39:19,019 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-12 04:39:19,036 - app_logger - INFO - Monday Database Utility initialized
2025-01-12 04:39:19,036 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:39:19,036 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-12 04:39:19,036 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:39:19,037 - app_logger - INFO - Monday Service initialized
2025-01-12 04:39:19,037 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-12 04:39:19,037 - app_logger - INFO - PO Log Database Util initialized
2025-01-12 04:39:19,037 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:39:19,037 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-12 04:39:19,037 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-12 04:39:19,037 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-12 04:39:19,061 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 04:39:19,061 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:39:19,065 - app_logger - INFO - OCR Service initialized
2025-01-12 04:39:19,065 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-12 04:39:19,065 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 04:39:19,065 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 04:39:19,066 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:39:19,066 - app_logger - DEBUG - Initialized XeroServices.
2025-01-12 04:39:19,066 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-12 04:39:19,126 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 04:39:19,126 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:39:19,126 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 04:39:19,126 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 04:39:19,126 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 04:39:19,126 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-12 04:39:19,126 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-12 04:39:19,126 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-12 04:39:19,126 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-12 04:39:19,127 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 04:39:19,129 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-12 04:39:19,143 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-12 04:39:19,143 - app_logger - INFO - Database initialized.
2025-01-12 04:39:19,143 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 04:39:19,143 - app_logger - INFO - Orchestrator initialized.
2025-01-12 04:39:19,143 - app_logger - INFO - Starting background tasks...
2025-01-12 04:39:19,143 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-12 04:39:19,179 - app_logger - INFO - Flask server running on port 5002.
2025-01-12 04:39:32,537 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:39:32,538 - app_logger - INFO - Starting to process event data...
2025-01-12 04:39:32,538 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:39:32,700 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 04:39:32,702 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:39:32,702 - app_logger - INFO - Changes (1):
2025-01-12 04:39:32,702 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:39:32,702 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:39:32,703 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:39:32,703 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:39:33,492 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 04:39:34,361 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:39:34,361 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:39:34,717 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 04:39:35,358 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 04:39:35,359 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 04:39:35,389 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 04:39:35,389 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:39:35,390 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 04:39:35,390 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:39:35,390 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:39:35,390 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 04:39:35,393 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 04:39:35,438 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:39:35,438 - app_logger - DEBUG - Created a new instance of DatabaseTriggerService.
2025-01-12 04:39:35,438 - app_logger - DEBUG - Preparing to enqueue invoice_update for invoice_id=89
2025-01-12 04:39:35,469 - app_logger - INFO - Successfully enqueued invoice_update for invoice_id=89
2025-01-12 04:39:35,470 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 04:39:35,471 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:39:35,472 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:39:35,472 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:39:35,484 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:39:35,484 - app_logger - INFO - Starting to process event data...
2025-01-12 04:39:35,484 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:39:35,618 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 04:39:35,619 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:39:35,619 - app_logger - INFO - Changes (0):
2025-01-12 04:39:35,619 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:58:07,249 - app_logger - INFO - Shutting down the application...
2025-01-12 04:58:09,669 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-12 04:58:09,669 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-12 04:58:09,669 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-12 04:58:09,669 - app_logger - INFO - Starting the application...
2025-01-12 04:58:09,838 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-12 04:58:09,838 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-12 04:58:09,839 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-12 04:58:10,030 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 04:58:11,072 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 04:58:11,075 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-12 04:58:11,237 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 04:58:11,856 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 04:58:11,857 - app_logger - INFO - Dropbox Util  initialized
2025-01-12 04:58:11,857 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-12 04:58:12,521 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-12 04:58:12,789 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-12 04:58:12,789 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-12 04:58:12,790 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-12 04:58:12,790 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-12 04:58:12,790 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-12 04:58:12,808 - app_logger - INFO - Monday Database Utility initialized
2025-01-12 04:58:12,808 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:58:12,808 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-12 04:58:12,808 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:58:12,808 - app_logger - INFO - Monday Service initialized
2025-01-12 04:58:12,808 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-12 04:58:12,808 - app_logger - INFO - PO Log Database Util initialized
2025-01-12 04:58:12,808 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:58:12,808 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-12 04:58:12,808 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-12 04:58:12,808 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-12 04:58:12,830 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 04:58:12,830 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:58:12,835 - app_logger - INFO - OCR Service initialized
2025-01-12 04:58:12,835 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-12 04:58:12,835 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 04:58:12,835 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 04:58:12,835 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:58:12,835 - app_logger - DEBUG - Initialized XeroServices.
2025-01-12 04:58:12,835 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-12 04:58:12,901 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 04:58:12,902 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:58:12,902 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 04:58:12,903 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 04:58:12,903 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 04:58:12,903 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-12 04:58:12,903 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-12 04:58:12,903 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-12 04:58:12,903 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-12 04:58:12,903 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 04:58:12,906 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-12 04:58:12,921 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-12 04:58:12,921 - app_logger - INFO - Database initialized.
2025-01-12 04:58:12,921 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 04:58:12,921 - app_logger - INFO - Orchestrator initialized.
2025-01-12 04:58:12,921 - app_logger - INFO - Starting background tasks...
2025-01-12 04:58:12,922 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-12 04:58:12,952 - app_logger - INFO - Flask server running on port 5002.
2025-01-12 04:58:27,485 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:58:27,485 - app_logger - INFO - Starting to process event data...
2025-01-12 04:58:27,486 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:58:27,668 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 04:58:27,674 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:58:27,674 - app_logger - INFO - Changes (1):
2025-01-12 04:58:27,674 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:58:27,674 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:58:27,675 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:58:27,675 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:58:28,281 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 04:58:29,158 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:58:29,159 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 04:58:29,574 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 04:58:30,259 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 04:58:30,260 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 04:58:30,282 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 04:58:30,282 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:58:30,284 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 04:58:30,284 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:58:30,284 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 04:58:30,284 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 04:58:30,287 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 04:58:30,326 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 04:58:30,326 - app_logger - DEBUG - Created a new instance of DatabaseTriggerService.
2025-01-12 04:58:30,326 - app_logger - DEBUG - Preparing to enqueue invoice_update for invoice_id=89
2025-01-12 04:58:30,360 - app_logger - INFO - Successfully enqueued invoice_update for invoice_id=89
2025-01-12 04:58:30,360 - app_logger - DEBUG - ü™Ñ Flushed updated Invoice(id=89).
2025-01-12 04:58:30,361 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 04:58:30,362 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 04:58:30,363 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 04:58:30,363 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 04:58:30,375 - app_logger - INFO - Received Dropbox event.
2025-01-12 04:58:30,375 - app_logger - INFO - Starting to process event data...
2025-01-12 04:58:30,376 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 04:58:30,508 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 04:58:30,509 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 04:58:30,509 - app_logger - INFO - Changes (0):
2025-01-12 04:58:30,509 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 05:03:38,836 - app_logger - INFO - Shutting down the application...
2025-01-12 05:03:42,076 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-12 05:03:42,076 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-12 05:03:42,076 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-12 05:03:42,077 - app_logger - INFO - Starting the application...
2025-01-12 05:03:42,248 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-12 05:03:42,248 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-12 05:03:42,248 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-12 05:03:42,437 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 05:03:43,287 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 05:03:43,290 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-12 05:03:43,460 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 05:03:44,208 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 05:03:44,208 - app_logger - INFO - Dropbox Util  initialized
2025-01-12 05:03:44,209 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-12 05:03:44,825 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-12 05:03:45,106 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-12 05:03:45,106 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-12 05:03:45,107 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-12 05:03:45,107 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-12 05:03:45,107 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-12 05:03:45,139 - app_logger - INFO - Monday Database Utility initialized
2025-01-12 05:03:45,139 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:03:45,139 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-12 05:03:45,139 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:03:45,139 - app_logger - INFO - Monday Service initialized
2025-01-12 05:03:45,139 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-12 05:03:45,140 - app_logger - INFO - PO Log Database Util initialized
2025-01-12 05:03:45,140 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:03:45,140 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-12 05:03:45,140 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-12 05:03:45,140 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-12 05:03:45,166 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 05:03:45,166 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:03:45,171 - app_logger - INFO - OCR Service initialized
2025-01-12 05:03:45,171 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-12 05:03:45,171 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 05:03:45,171 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 05:03:45,172 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:03:45,172 - app_logger - DEBUG - Initialized XeroServices.
2025-01-12 05:03:45,172 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-12 05:03:45,234 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 05:03:45,234 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:03:45,234 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 05:03:45,234 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 05:03:45,234 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 05:03:45,234 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-12 05:03:45,234 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-12 05:03:45,234 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-12 05:03:45,234 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-12 05:03:45,235 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 05:03:45,237 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-12 05:03:45,250 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-12 05:03:45,250 - app_logger - INFO - Database initialized.
2025-01-12 05:03:45,250 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 05:03:45,250 - app_logger - INFO - Orchestrator initialized.
2025-01-12 05:03:45,250 - app_logger - INFO - Starting background tasks...
2025-01-12 05:03:45,250 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-12 05:03:45,316 - app_logger - INFO - Flask server running on port 5002.
2025-01-12 05:04:22,616 - app_logger - INFO - Received Dropbox event.
2025-01-12 05:04:22,617 - app_logger - INFO - Starting to process event data...
2025-01-12 05:04:22,617 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 05:04:22,786 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 05:04:22,788 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 05:04:22,789 - app_logger - INFO - Changes (1):
2025-01-12 05:04:22,789 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:04:22,789 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:04:22,789 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:04:22,789 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:04:23,385 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 05:04:24,305 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 05:04:24,305 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 05:04:24,804 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 05:04:25,493 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 05:04:25,493 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 05:04:25,516 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 05:04:25,516 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 05:04:25,516 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 05:04:25,516 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 05:04:25,516 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 05:04:25,516 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 05:04:25,519 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 05:04:25,554 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:04:25,554 - app_logger - DEBUG - Created a new instance of DatabaseTriggerService.
2025-01-12 05:04:25,554 - app_logger - DEBUG - Preparing to enqueue invoice_update for invoice_id=89
2025-01-12 05:04:25,585 - app_logger - INFO - Successfully enqueued invoice_update for invoice_id=89
2025-01-12 05:04:25,586 - app_logger - DEBUG - ü™Ñ Flushed updated Invoice(id=89).
2025-01-12 05:04:25,586 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 05:04:25,587 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 05:04:25,588 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:04:25,588 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 05:04:25,600 - app_logger - INFO - Received Dropbox event.
2025-01-12 05:04:25,600 - app_logger - INFO - Starting to process event data...
2025-01-12 05:04:25,600 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 05:04:25,748 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 05:04:25,748 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 05:04:25,748 - app_logger - INFO - Changes (0):
2025-01-12 05:04:25,749 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 05:04:52,124 - app_logger - INFO - Received Dropbox event.
2025-01-12 05:04:52,124 - app_logger - INFO - Starting to process event data...
2025-01-12 05:04:52,124 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 05:04:52,509 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 05:04:52,511 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 05:04:52,512 - app_logger - INFO - Changes (1):
2025-01-12 05:04:52,512 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:04:52,512 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:04:52,513 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:04:52,513 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:04:53,130 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 05:04:54,143 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 05:04:54,144 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 05:04:54,524 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 05:04:55,185 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 05:04:55,186 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 05:04:55,193 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 05:04:55,193 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 05:04:55,194 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 05:04:55,194 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 05:04:55,195 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 05:04:55,195 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 05:04:55,206 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 05:04:55,207 - app_logger - DEBUG - Preparing to enqueue invoice_update for invoice_id=89
2025-01-12 05:04:55,211 - app_logger - INFO - Successfully enqueued invoice_update for invoice_id=89
2025-01-12 05:04:55,211 - app_logger - DEBUG - ü™Ñ Flushed updated Invoice(id=89).
2025-01-12 05:04:55,212 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 05:04:55,213 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 05:04:55,214 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:04:55,216 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 05:04:55,228 - app_logger - INFO - Received Dropbox event.
2025-01-12 05:04:55,228 - app_logger - INFO - Starting to process event data...
2025-01-12 05:04:55,229 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 05:04:55,398 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 05:04:55,398 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 05:04:55,398 - app_logger - INFO - Changes (0):
2025-01-12 05:04:55,399 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 05:14:12,650 - app_logger - INFO - Shutting down the application...
2025-01-12 05:16:32,843 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-12 05:16:32,843 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-12 05:16:32,843 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-12 05:16:32,843 - app_logger - INFO - Starting the application...
2025-01-12 05:16:33,014 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-12 05:16:33,014 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-12 05:16:33,014 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-12 05:16:33,255 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 05:16:34,093 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 05:16:34,099 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-12 05:16:34,302 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 05:16:34,969 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 05:16:34,969 - app_logger - INFO - Dropbox Util  initialized
2025-01-12 05:16:34,969 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-12 05:16:35,474 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-12 05:16:35,883 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-12 05:16:35,884 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-12 05:16:35,884 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-12 05:16:35,884 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-12 05:16:35,884 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-12 05:16:35,910 - app_logger - INFO - Monday Database Utility initialized
2025-01-12 05:16:35,910 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:16:35,910 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-12 05:16:35,910 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:16:35,910 - app_logger - INFO - Monday Service initialized
2025-01-12 05:16:35,911 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-12 05:16:35,911 - app_logger - INFO - PO Log Database Util initialized
2025-01-12 05:16:35,911 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:16:35,911 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-12 05:16:35,912 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-12 05:16:35,912 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-12 05:16:35,944 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 05:16:35,944 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:16:35,948 - app_logger - INFO - OCR Service initialized
2025-01-12 05:16:35,949 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-12 05:16:35,949 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 05:16:35,949 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 05:16:35,949 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:16:35,949 - app_logger - DEBUG - Initialized XeroServices.
2025-01-12 05:16:35,949 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-12 05:16:36,026 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 05:16:36,026 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:16:36,026 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 05:16:36,026 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 05:16:36,026 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 05:16:36,027 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-12 05:16:36,027 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-12 05:16:36,027 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-12 05:16:36,027 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-12 05:16:36,028 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 05:16:36,030 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-12 05:16:36,044 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-12 05:16:36,044 - app_logger - INFO - Database initialized.
2025-01-12 05:16:36,044 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 05:16:36,044 - app_logger - INFO - Orchestrator initialized.
2025-01-12 05:16:36,044 - app_logger - INFO - Starting background tasks...
2025-01-12 05:16:36,044 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-12 05:16:36,082 - app_logger - INFO - Flask server running on port 5002.
2025-01-12 05:17:17,642 - app_logger - INFO - Received Dropbox event.
2025-01-12 05:17:17,642 - app_logger - INFO - Starting to process event data...
2025-01-12 05:17:17,643 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 05:17:17,821 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 05:17:17,829 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 05:17:17,829 - app_logger - INFO - Changes (1):
2025-01-12 05:17:17,830 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:17:17,830 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:17:17,830 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:17:17,830 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:17:18,392 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 05:17:19,193 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 05:17:19,193 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 05:17:19,722 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 05:17:20,560 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 05:17:20,561 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 05:17:20,585 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 05:17:20,585 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 05:17:20,585 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 05:17:20,585 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 05:17:20,586 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 05:17:20,586 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 05:17:20,588 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 05:17:20,627 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:17:20,627 - app_logger - DEBUG - Created a new instance of DatabaseTriggerService.
2025-01-12 05:17:20,628 - app_logger - DEBUG - Preparing to enqueue invoice_update for invoice_id=89
2025-01-12 05:17:20,664 - app_logger - INFO - Successfully enqueued invoice_update for invoice_id=89
2025-01-12 05:17:20,664 - app_logger - DEBUG - ü™Ñ Flushed updated Invoice(id=89).
2025-01-12 05:17:20,665 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 05:17:20,667 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 05:17:20,668 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:17:20,668 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 05:17:20,680 - app_logger - INFO - Received Dropbox event.
2025-01-12 05:17:20,680 - app_logger - INFO - Starting to process event data...
2025-01-12 05:17:20,680 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 05:17:20,817 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 05:17:20,818 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 05:17:20,818 - app_logger - INFO - Changes (0):
2025-01-12 05:17:20,818 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 05:24:15,779 - app_logger - INFO - Received Dropbox event.
2025-01-12 05:24:15,780 - app_logger - INFO - Starting to process event data...
2025-01-12 05:24:15,781 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 05:24:16,062 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 05:24:16,064 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 05:24:16,064 - app_logger - INFO - Changes (1):
2025-01-12 05:24:16,064 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:24:16,064 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:24:16,064 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:24:16,065 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:24:16,675 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 05:24:17,739 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 05:24:17,739 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 05:24:18,199 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 05:24:18,925 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 05:24:18,925 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 05:24:18,931 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 05:24:18,931 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 05:24:18,932 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 05:24:18,932 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 05:24:18,932 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 05:24:18,932 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 05:24:18,934 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 05:24:18,934 - app_logger - DEBUG - Preparing to enqueue invoice_update for invoice_id=89
2025-01-12 05:24:18,938 - app_logger - INFO - Successfully enqueued invoice_update for invoice_id=89
2025-01-12 05:24:18,938 - app_logger - DEBUG - ü™Ñ Flushed updated Invoice(id=89).
2025-01-12 05:24:18,940 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 05:24:18,944 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 05:24:18,945 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:24:18,946 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 05:24:18,958 - app_logger - INFO - Received Dropbox event.
2025-01-12 05:24:18,958 - app_logger - INFO - Starting to process event data...
2025-01-12 05:24:18,958 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 05:24:19,094 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 05:24:19,095 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 05:24:19,095 - app_logger - INFO - Changes (0):
2025-01-12 05:24:19,095 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 05:33:51,102 - app_logger - INFO - Shutting down the application...
2025-01-12 05:33:54,277 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-12 05:33:54,277 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-12 05:33:54,277 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-12 05:33:54,277 - app_logger - INFO - Starting the application...
2025-01-12 05:33:54,434 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-12 05:33:54,434 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-12 05:33:54,434 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-12 05:33:54,624 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 05:33:55,284 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 05:33:55,288 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-12 05:33:55,460 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 05:33:56,126 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 05:33:56,126 - app_logger - INFO - Dropbox Util  initialized
2025-01-12 05:33:56,126 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-12 05:33:56,622 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-12 05:33:56,877 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-12 05:33:56,877 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-12 05:33:56,878 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-12 05:33:56,878 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-12 05:33:56,878 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-12 05:33:56,898 - app_logger - INFO - Monday Database Utility initialized
2025-01-12 05:33:56,898 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:33:56,898 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-12 05:33:56,898 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:33:56,898 - app_logger - INFO - Monday Service initialized
2025-01-12 05:33:56,898 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-12 05:33:56,898 - app_logger - INFO - PO Log Database Util initialized
2025-01-12 05:33:56,898 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:33:56,899 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-12 05:33:56,899 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-12 05:33:56,899 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-12 05:33:56,925 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 05:33:56,925 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:33:56,930 - app_logger - INFO - OCR Service initialized
2025-01-12 05:33:56,930 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-12 05:33:56,930 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 05:33:56,930 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 05:33:56,931 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:33:56,931 - app_logger - DEBUG - Initialized XeroServices.
2025-01-12 05:33:56,931 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-12 05:33:56,990 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 05:33:56,990 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:33:56,990 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 05:33:56,990 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 05:33:56,990 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 05:33:56,990 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-12 05:33:56,990 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-12 05:33:56,991 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-12 05:33:56,991 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-12 05:33:56,991 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 05:33:56,996 - app_logger - INFO - ‚úÖ All table triggers (insert, update, delete) have been registered successfully!
2025-01-12 05:33:57,009 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-12 05:33:57,009 - app_logger - INFO - Database initialized.
2025-01-12 05:33:57,009 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 05:33:57,009 - app_logger - INFO - Orchestrator initialized.
2025-01-12 05:33:57,009 - app_logger - INFO - Starting background tasks...
2025-01-12 05:33:57,009 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-12 05:33:57,047 - app_logger - INFO - Flask server running on port 5002.
2025-01-12 05:34:45,950 - app_logger - INFO - Received Dropbox event.
2025-01-12 05:34:45,951 - app_logger - INFO - Starting to process event data...
2025-01-12 05:34:45,951 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 05:34:46,112 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 05:34:46,114 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 05:34:46,115 - app_logger - INFO - Changes (1):
2025-01-12 05:34:46,115 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:34:46,115 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:34:46,115 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:34:46,115 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:34:46,650 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 05:34:49,015 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 05:34:49,015 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 05:34:49,485 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 05:34:50,348 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 05:34:50,348 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 05:34:50,362 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 05:34:50,362 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 05:34:50,362 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 05:34:50,363 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 05:34:50,363 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 05:34:50,363 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 05:34:50,364 - app_logger - DEBUG - [INVOICE AFTER UPDATE] Invoice(id=89) updated.
2025-01-12 05:34:50,398 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 05:34:50,398 - app_logger - DEBUG - Created a new instance of DatabaseTriggerService.
2025-01-12 05:34:50,398 - app_logger - DEBUG - Preparing to enqueue invoice_update for invoice_id=89
2025-01-12 05:34:50,434 - app_logger - INFO - Successfully enqueued invoice_update for invoice_id=89
2025-01-12 05:34:50,435 - app_logger - DEBUG - ü™Ñ Flushed updated Invoice(id=89).
2025-01-12 05:34:50,435 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 05:34:50,437 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 05:34:50,437 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 05:34:50,438 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 05:34:50,450 - app_logger - INFO - Received Dropbox event.
2025-01-12 05:34:50,450 - app_logger - INFO - Starting to process event data...
2025-01-12 05:34:50,450 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 05:34:50,599 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 05:34:50,599 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 05:34:50,599 - app_logger - INFO - Changes (0):
2025-01-12 05:34:50,600 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 06:23:31,635 - Trigger-logs - DEBUG - Added file handler to app_logger.
2025-01-12 06:23:31,636 - Trigger-logs - DEBUG - Added console handler to app_logger.
2025-01-12 06:23:31,636 - Trigger-logs - DEBUG - [DEBUG] Trigger-logs has 2 handlers attached.
2025-01-12 06:25:43,341 - Trigger-logs - DEBUG - Added file handler to app_logger.
2025-01-12 06:25:43,341 - Trigger-logs - DEBUG - Added console handler to app_logger.
2025-01-12 06:25:43,341 - Trigger-logs - DEBUG - [DEBUG] Trigger-logs has 2 handlers attached.
2025-01-12 06:27:12,605 - Trigger-logs - DEBUG - Added file handler to app_logger.
2025-01-12 06:27:12,605 - Trigger-logs - DEBUG - Added console handler to app_logger.
2025-01-12 06:27:12,605 - Trigger-logs - DEBUG - [DEBUG] Trigger-logs has 2 handlers attached.
2025-01-12 06:28:09,696 - Trigger-logs - DEBUG - Added file handler to app_logger.
2025-01-12 06:28:09,696 - Trigger-logs - DEBUG - Added console handler to app_logger.
2025-01-12 06:28:09,696 - Trigger-logs - DEBUG - [DEBUG] Trigger-logs has 2 handlers attached.
2025-01-12 06:28:30,273 - app_logger - INFO - Shutting down the application...
2025-01-12 06:28:31,985 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-12 06:28:31,985 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-12 06:28:31,985 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-12 06:28:31,985 - app_logger - INFO - Starting the application...
2025-01-12 06:28:32,151 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-12 06:28:32,151 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-12 06:28:32,152 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-12 06:28:32,347 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 06:28:33,178 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 06:28:33,183 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-12 06:28:33,354 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 06:28:34,064 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 06:28:34,064 - app_logger - INFO - Dropbox Util  initialized
2025-01-12 06:28:34,064 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-12 06:28:34,883 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-12 06:28:35,372 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-12 06:28:35,372 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-12 06:28:35,372 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-12 06:28:35,372 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-12 06:28:35,372 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-12 06:28:35,387 - app_logger - INFO - Monday Database Utility initialized
2025-01-12 06:28:35,388 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 06:28:35,388 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-12 06:28:35,388 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 06:28:35,388 - app_logger - INFO - Monday Service initialized
2025-01-12 06:28:35,388 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-12 06:28:35,388 - app_logger - INFO - PO Log Database Util initialized
2025-01-12 06:28:35,388 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 06:28:35,388 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-12 06:28:35,388 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-12 06:28:35,388 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-12 06:28:35,409 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 06:28:35,409 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 06:28:35,413 - app_logger - INFO - OCR Service initialized
2025-01-12 06:28:35,413 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-12 06:28:35,413 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 06:28:35,413 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 06:28:35,414 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 06:28:35,414 - app_logger - DEBUG - Initialized XeroServices.
2025-01-12 06:28:35,414 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-12 06:28:35,472 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 06:28:35,472 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 06:28:35,472 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 06:28:35,472 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 06:28:35,472 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 06:28:35,473 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-12 06:28:35,473 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-12 06:28:35,473 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-12 06:28:35,473 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-12 06:28:35,473 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 06:28:35,488 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-12 06:28:35,488 - app_logger - INFO - Database initialized.
2025-01-12 06:28:35,488 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 06:28:35,488 - app_logger - INFO - Orchestrator initialized.
2025-01-12 06:28:35,488 - app_logger - INFO - Starting background tasks...
2025-01-12 06:28:35,488 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-12 06:28:35,531 - app_logger - INFO - Flask server running on port 5002.
2025-01-12 06:30:13,289 - app_logger - INFO - Received Dropbox event.
2025-01-12 06:30:13,289 - app_logger - INFO - Starting to process event data...
2025-01-12 06:30:13,290 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 06:30:13,701 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 06:30:13,705 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 06:30:13,708 - app_logger - INFO - Changes (1):
2025-01-12 06:30:13,708 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 06:30:13,708 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 06:30:13,709 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 06:30:13,709 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 06:30:14,620 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 06:30:15,493 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 06:30:15,494 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 06:30:15,999 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 06:30:16,728 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 06:30:16,728 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 06:30:16,742 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 06:30:16,742 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 06:30:16,743 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 06:30:16,743 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 06:30:16,743 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 06:30:16,743 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 06:30:16,744 - app_logger - DEBUG - ü™Ñ Flushed updated Invoice(id=89).
2025-01-12 06:30:16,745 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 06:30:16,746 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 06:30:16,746 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 06:30:16,747 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 06:30:16,758 - app_logger - INFO - Received Dropbox event.
2025-01-12 06:30:16,759 - app_logger - INFO - Starting to process event data...
2025-01-12 06:30:16,759 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 06:30:16,903 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 06:30:16,905 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 06:30:16,905 - app_logger - INFO - Changes (0):
2025-01-12 06:30:16,906 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 06:32:40,050 - app_logger - INFO - Received Dropbox event.
2025-01-12 06:32:40,053 - app_logger - INFO - Starting to process event data...
2025-01-12 06:32:40,054 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 06:32:40,311 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 06:32:40,313 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 06:32:40,313 - app_logger - INFO - Changes (1):
2025-01-12 06:32:40,313 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 06:32:40,314 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 06:32:40,314 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 06:32:40,314 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 06:32:40,957 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 06:32:42,247 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 06:32:42,248 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 06:32:43,051 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 06:32:44,230 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 06:32:44,231 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 06:32:44,238 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 06:32:44,239 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 06:32:44,240 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 06:32:44,241 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=89), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 06:32:44,241 - app_logger - DEBUG - üîß Attempting to update Invoice(id=89). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 06:32:44,241 - app_logger - INFO - ü§ù Checking if Invoice(id=89) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 06:32:44,245 - app_logger - DEBUG - ü™Ñ Flushed updated Invoice(id=89).
2025-01-12 06:32:44,246 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 06:32:44,250 - app_logger - DEBUG - ü§ì Pulling record: 89 from table invoice
2025-01-12 06:32:44,252 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 06:32:44,254 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 06:32:44,269 - app_logger - INFO - Received Dropbox event.
2025-01-12 06:32:44,269 - app_logger - INFO - Starting to process event data...
2025-01-12 06:32:44,270 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 06:32:44,454 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 06:32:44,456 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 06:32:44,456 - app_logger - INFO - Changes (0):
2025-01-12 06:32:44,457 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 06:35:44,386 - app_logger - INFO - Received Dropbox event.
2025-01-12 06:35:44,387 - app_logger - INFO - Starting to process event data...
2025-01-12 06:35:44,388 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 06:35:44,671 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 06:35:44,672 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 06:35:44,672 - app_logger - INFO - Changes (1):
2025-01-12 06:35:44,672 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 06:35:44,672 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 06:35:44,672 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 06:35:44,672 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 06:35:45,515 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 06:35:46,428 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 06:35:46,430 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 06:35:47,022 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 06:35:47,868 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 06:35:47,869 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 06:35:47,876 - app_logger - INFO - üôÖ No Invoices matched.
2025-01-12 06:35:47,877 - app_logger - INFO - üÜï Creating new invoice #1 for PO 21 (project 2416).
2025-01-12 06:35:47,878 - app_logger - DEBUG - üßæ create_invoice with {'project_number': 2416, 'po_number': 21, 'invoice_number': 1, 'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 06:35:47,878 - app_logger - DEBUG - üßë‚Äçüíª Creating new Invoice using data: {'project_number': 2416, 'po_number': 21, 'invoice_number': 1, 'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 06:35:47,878 - app_logger - INFO - üå± About to insert a fresh record into Invoice with {'project_number': 2416, 'po_number': 21, 'invoice_number': 1, 'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 06:35:47,885 - app_logger - DEBUG - ü™Ñ Flushed new Invoice. ID now: 90
2025-01-12 06:35:47,886 - app_logger - INFO - üéâ Creation successful! Record is now in the DB.
2025-01-12 06:35:47,889 - app_logger - DEBUG - ü§ì Pulling record: 90 from table invoice
2025-01-12 06:35:47,892 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 06:35:47,894 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 06:35:47,910 - app_logger - INFO - Received Dropbox event.
2025-01-12 06:35:47,910 - app_logger - INFO - Starting to process event data...
2025-01-12 06:35:47,911 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 06:35:48,058 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 06:35:48,062 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 06:35:48,062 - app_logger - INFO - Changes (0):
2025-01-12 06:35:48,064 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 14:11:11,109 - app_logger - INFO - Received Dropbox event.
2025-01-12 14:11:11,111 - app_logger - INFO - Starting to process event data...
2025-01-12 14:11:11,112 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 14:11:11,648 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 14:11:11,651 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 14:11:11,651 - app_logger - INFO - Changes (1):
2025-01-12 14:11:11,651 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 14:11:11,651 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 14:11:11,651 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 14:11:11,651 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 14:11:12,424 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 14:11:13,240 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 14:11:13,241 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 14:11:14,526 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 14:11:15,293 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 14:11:15,293 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 14:11:15,299 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 14:11:15,299 - app_logger - DEBUG - ü§ì Pulling record: 90 from table invoice
2025-01-12 14:11:15,301 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 14:11:15,301 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=90), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 14:11:15,301 - app_logger - DEBUG - üîß Attempting to update Invoice(id=90). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 14:11:15,301 - app_logger - INFO - ü§ù Checking if Invoice(id=90) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 14:11:15,306 - app_logger - DEBUG - ü™Ñ Flushed updated Invoice(id=90).
2025-01-12 14:11:15,308 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 14:11:15,309 - app_logger - DEBUG - ü§ì Pulling record: 90 from table invoice
2025-01-12 14:11:15,310 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 14:11:15,312 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 14:11:15,324 - app_logger - INFO - Received Dropbox event.
2025-01-12 14:11:15,324 - app_logger - INFO - Starting to process event data...
2025-01-12 14:11:15,324 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 14:11:15,488 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 14:11:15,491 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 14:11:15,491 - app_logger - INFO - Changes (0):
2025-01-12 14:11:15,492 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 14:11:27,394 - Trigger-logs - DEBUG - Added file handler to app_logger.
2025-01-12 14:11:27,394 - Trigger-logs - DEBUG - Added console handler to app_logger.
2025-01-12 14:11:27,394 - Trigger-logs - DEBUG - [DEBUG] Trigger-logs has 2 handlers attached.
2025-01-12 14:21:54,011 - Trigger-logs - DEBUG - Added file handler to app_logger.
2025-01-12 14:21:54,011 - Trigger-logs - DEBUG - Added console handler to app_logger.
2025-01-12 14:21:54,011 - Trigger-logs - DEBUG - [DEBUG] Trigger-logs has 2 handlers attached.
2025-01-12 14:22:53,041 - Trigger-logs - DEBUG - Added file handler to app_logger.
2025-01-12 14:22:53,042 - Trigger-logs - DEBUG - Added console handler to app_logger.
2025-01-12 14:22:53,042 - Trigger-logs - DEBUG - [DEBUG] Trigger-logs has 2 handlers attached.
2025-01-12 14:22:59,510 - Trigger-logs - DEBUG - Added file handler to app_logger.
2025-01-12 14:22:59,510 - Trigger-logs - DEBUG - Added console handler to app_logger.
2025-01-12 14:22:59,510 - Trigger-logs - DEBUG - [DEBUG] Trigger-logs has 2 handlers attached.
2025-01-12 14:23:32,812 - app_logger - INFO - Shutting down the application...
2025-01-12 16:24:52,180 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-12 16:24:52,180 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-12 16:24:52,180 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-12 16:24:52,180 - app_logger - INFO - Starting the application...
2025-01-12 16:24:52,409 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-12 16:24:52,409 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-12 16:24:52,409 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-12 16:24:52,924 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 16:24:54,088 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 16:24:54,094 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-12 16:24:54,335 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 16:24:55,027 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 16:24:55,027 - app_logger - INFO - Dropbox Util  initialized
2025-01-12 16:24:55,027 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-12 16:24:55,750 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-12 16:24:56,161 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-12 16:24:56,162 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-12 16:24:56,163 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-12 16:24:56,164 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-12 16:24:56,164 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-12 16:24:56,228 - app_logger - INFO - Monday Database Utility initialized
2025-01-12 16:24:56,228 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 16:24:56,228 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-12 16:24:56,228 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 16:24:56,228 - app_logger - INFO - Monday Service initialized
2025-01-12 16:24:56,228 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-12 16:24:56,228 - app_logger - INFO - PO Log Database Util initialized
2025-01-12 16:24:56,229 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 16:24:56,229 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-12 16:24:56,229 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-12 16:24:56,229 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-12 16:24:56,265 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 16:24:56,265 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 16:24:56,269 - app_logger - INFO - OCR Service initialized
2025-01-12 16:24:56,269 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-12 16:24:56,269 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 16:24:56,269 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 16:24:56,270 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 16:24:56,270 - app_logger - DEBUG - Initialized XeroServices.
2025-01-12 16:24:56,270 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-12 16:24:56,313 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 16:24:56,314 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 16:24:56,314 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 16:24:56,314 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 16:24:56,314 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 16:24:56,314 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-12 16:24:56,314 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-12 16:24:56,315 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-12 16:24:56,315 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-12 16:24:56,316 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 16:24:56,335 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-12 16:24:56,335 - app_logger - INFO - Database initialized.
2025-01-12 16:24:56,335 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 16:24:56,335 - app_logger - INFO - Orchestrator initialized.
2025-01-12 16:24:56,335 - app_logger - INFO - Starting background tasks...
2025-01-12 16:24:56,335 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-12 16:24:56,375 - app_logger - INFO - Flask server running on port 5002.
2025-01-12 16:25:49,049 - Trigger-logs - DEBUG - Added file handler to app_logger.
2025-01-12 16:25:49,049 - Trigger-logs - DEBUG - Added console handler to app_logger.
2025-01-12 16:25:49,049 - Trigger-logs - DEBUG - [DEBUG] Trigger-logs has 2 handlers attached.
2025-01-12 16:53:20,051 - Trigger-logs - DEBUG - Added file handler to app_logger.
2025-01-12 16:53:20,051 - Trigger-logs - DEBUG - Added console handler to app_logger.
2025-01-12 16:53:20,051 - Trigger-logs - DEBUG - [DEBUG] Trigger-logs has 2 handlers attached.
2025-01-12 16:53:21,262 - Trigger-logs - DEBUG - Added file handler to app_logger.
2025-01-12 16:53:21,262 - Trigger-logs - DEBUG - Added console handler to app_logger.
2025-01-12 16:53:21,262 - Trigger-logs - DEBUG - [DEBUG] Trigger-logs has 2 handlers attached.
2025-01-12 18:03:11,181 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-12 18:03:11,182 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-12 18:03:11,182 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-12 18:03:11,182 - app_logger - INFO - Starting the application...
2025-01-12 18:03:11,345 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-12 18:03:11,345 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-12 18:03:11,345 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-12 18:03:11,526 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 18:03:13,170 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 18:03:13,175 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-12 18:03:13,354 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 18:03:15,166 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 18:03:15,169 - app_logger - INFO - Dropbox Util  initialized
2025-01-12 18:03:15,169 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-12 18:03:15,793 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-12 18:03:16,407 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-12 18:03:16,408 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-12 18:03:16,410 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-12 18:03:16,410 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-12 18:03:16,411 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-12 18:03:16,450 - app_logger - INFO - Monday Database Utility initialized
2025-01-12 18:03:16,450 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 18:03:16,451 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-12 18:03:16,451 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 18:03:16,451 - app_logger - INFO - Monday Service initialized
2025-01-12 18:03:16,451 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-12 18:03:16,451 - app_logger - INFO - PO Log Database Util initialized
2025-01-12 18:03:16,451 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 18:03:16,451 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-12 18:03:16,451 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-12 18:03:16,452 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-12 18:03:16,482 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 18:03:16,482 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 18:03:16,487 - app_logger - INFO - OCR Service initialized
2025-01-12 18:03:16,487 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-12 18:03:16,487 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 18:03:16,487 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 18:03:16,488 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 18:03:16,488 - app_logger - DEBUG - Initialized XeroServices.
2025-01-12 18:03:16,488 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-12 18:03:16,548 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 18:03:16,548 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 18:03:16,548 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 18:03:16,548 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 18:03:16,549 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 18:03:16,549 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-12 18:03:16,549 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-12 18:03:16,549 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-12 18:03:16,549 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-12 18:03:16,549 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 18:03:16,566 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-12 18:03:16,566 - app_logger - INFO - Database initialized.
2025-01-12 18:03:16,566 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 18:03:16,566 - app_logger - INFO - Orchestrator initialized.
2025-01-12 18:03:16,566 - app_logger - INFO - Starting background tasks...
2025-01-12 18:03:16,566 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-12 18:03:16,630 - app_logger - INFO - Flask server running on port 5002.
2025-01-12 18:03:52,187 - app_logger - INFO - Shutting down the application...
2025-01-12 18:04:11,014 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-12 18:04:11,015 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-12 18:04:11,015 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-12 18:04:11,015 - app_logger - INFO - Starting the application...
2025-01-12 18:04:11,176 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-12 18:04:11,177 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-12 18:04:11,177 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-12 18:04:11,360 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 18:04:12,115 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 18:04:12,120 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-12 18:04:12,295 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 18:04:13,032 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 18:04:13,032 - app_logger - INFO - Dropbox Util  initialized
2025-01-12 18:04:13,032 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-12 18:04:13,351 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-12 18:04:13,950 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-12 18:04:13,950 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-12 18:04:13,951 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-12 18:04:13,951 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-12 18:04:13,951 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-12 18:04:13,972 - app_logger - INFO - Monday Database Utility initialized
2025-01-12 18:04:13,973 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 18:04:13,973 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-12 18:04:13,973 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 18:04:13,973 - app_logger - INFO - Monday Service initialized
2025-01-12 18:04:13,973 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-12 18:04:13,973 - app_logger - INFO - PO Log Database Util initialized
2025-01-12 18:04:13,973 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 18:04:13,973 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-12 18:04:13,974 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-12 18:04:13,974 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-12 18:04:14,002 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 18:04:14,002 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 18:04:14,007 - app_logger - INFO - OCR Service initialized
2025-01-12 18:04:14,007 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-12 18:04:14,007 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 18:04:14,007 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 18:04:14,008 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 18:04:14,008 - app_logger - DEBUG - Initialized XeroServices.
2025-01-12 18:04:14,008 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-12 18:04:14,066 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 18:04:14,066 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 18:04:14,066 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 18:04:14,066 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 18:04:14,067 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 18:04:14,067 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-12 18:04:14,067 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-12 18:04:14,067 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-12 18:04:14,067 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-12 18:04:14,067 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 18:04:14,082 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-12 18:04:14,082 - app_logger - INFO - Database initialized.
2025-01-12 18:04:14,082 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 18:04:14,082 - app_logger - INFO - Orchestrator initialized.
2025-01-12 18:04:14,082 - app_logger - INFO - Starting background tasks...
2025-01-12 18:04:14,083 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-12 18:04:14,092 - app_logger - INFO - Flask server running on port 5002.
2025-01-12 18:04:14,940 - Trigger-logs - DEBUG - Added file handler to app_logger.
2025-01-12 18:04:14,940 - Trigger-logs - DEBUG - Added console handler to app_logger.
2025-01-12 18:04:14,940 - Trigger-logs - DEBUG - [DEBUG] Trigger-logs has 2 handlers attached.
2025-01-12 18:05:13,805 - app_logger - INFO - Received Dropbox event.
2025-01-12 18:05:13,806 - app_logger - INFO - Starting to process event data...
2025-01-12 18:05:13,808 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 18:05:14,018 - app_logger - DEBUG - Fetched 2 changes.
2025-01-12 18:05:14,021 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 18:05:14,021 - app_logger - DEBUG - DELETE: DeletedMetadata(name='2416_21_01 Jordan Sakai Invoice.pdf', parent_shared_folder_id=NOT_SET, path_display='/2416 - Whop Keynote/4. Production/4.1 Creative Documents/2416_21_01 Jordan Sakai Invoice.pdf', path_lower='/2416 - whop keynote/4. production/4.1 creative documents/2416_21_01 jordan sakai invoice.pdf', preview_url=NOT_SET)
2025-01-12 18:05:14,021 - app_logger - INFO - Changes (1):
2025-01-12 18:05:14,021 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 18:05:14,021 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 18:05:14,022 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 18:05:14,022 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 18:05:14,639 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 18:05:15,924 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 18:05:15,925 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 18:05:16,576 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 18:05:17,663 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 18:05:17,664 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 18:05:17,688 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 18:05:17,688 - app_logger - DEBUG - ü§ì Pulling record: 90 from table invoice
2025-01-12 18:05:17,688 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 18:05:17,689 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=90), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 18:05:17,689 - app_logger - DEBUG - üîß Attempting to update Invoice(id=90). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 18:05:17,689 - app_logger - INFO - ü§ù Checking if Invoice(id=90) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 18:05:17,691 - app_logger - DEBUG - ü™Ñ Flushed updated Invoice(id=90).
2025-01-12 18:05:17,692 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 18:05:17,693 - app_logger - DEBUG - ü§ì Pulling record: 90 from table invoice
2025-01-12 18:05:17,693 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 18:05:17,694 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 18:05:17,706 - app_logger - INFO - Received Dropbox event.
2025-01-12 18:05:17,706 - app_logger - INFO - Starting to process event data...
2025-01-12 18:05:17,706 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 18:05:17,940 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 18:05:17,940 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 18:05:17,940 - app_logger - INFO - Changes (0):
2025-01-12 18:05:17,941 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 18:05:17,952 - app_logger - INFO - Received Dropbox event.
2025-01-12 18:05:17,952 - app_logger - INFO - Starting to process event data...
2025-01-12 18:05:17,952 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 18:05:18,936 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 18:05:18,938 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 18:05:18,938 - app_logger - INFO - Changes (0):
2025-01-12 18:05:18,939 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 18:05:18,953 - app_logger - INFO - Received Dropbox event.
2025-01-12 18:05:18,955 - app_logger - INFO - Starting to process event data...
2025-01-12 18:05:18,955 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 18:05:19,229 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 18:05:19,230 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 18:05:19,230 - app_logger - INFO - Changes (0):
2025-01-12 18:05:19,231 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 19:22:40,300 - app_logger - INFO - Shutting down the application...
2025-01-12 19:22:42,540 - app_logger - DEBUG - Added file handler to app_logger.
2025-01-12 19:22:42,540 - app_logger - DEBUG - Added console handler to app_logger.
2025-01-12 19:22:42,540 - app_logger - DEBUG - [DEBUG] app_logger has 2 handlers attached.
2025-01-12 19:22:42,540 - app_logger - INFO - Starting the application...
2025-01-12 19:22:42,701 - app_logger - DEBUG - Token is still valid, no refresh necessary.
2025-01-12 19:22:42,701 - app_logger - INFO - XeroAPI (PyXero) initialized.
2025-01-12 19:22:42,701 - app_logger - DEBUG - Created a new instance of XeroAPI.
2025-01-12 19:22:42,891 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 19:22:43,790 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 19:22:43,795 - app_logger - DEBUG - Created a new instance of DropboxAPI.
2025-01-12 19:22:43,971 - app_logger - INFO - Dropbox Client Initialized
2025-01-12 19:22:44,706 - app_logger - DEBUG - Created a new instance of DropboxClient.
2025-01-12 19:22:44,706 - app_logger - INFO - Dropbox Util  initialized
2025-01-12 19:22:44,706 - app_logger - DEBUG - Created a new instance of DropboxUtil.
2025-01-12 19:22:45,236 - app_logger - DEBUG - Found subitems column ID: subitems
2025-01-12 19:22:45,570 - app_logger - INFO - Retrieved subitem board ID: 7969894502
2025-01-12 19:22:45,570 - app_logger - DEBUG - Created a new instance of MondayUtil.
2025-01-12 19:22:45,571 - app_logger - DEBUG - Initializing MondayAPI singleton... ‚öôÔ∏è
2025-01-12 19:22:45,571 - app_logger - INFO - ‚úÖ Monday API initialized successfully üèóÔ∏è
2025-01-12 19:22:45,571 - app_logger - DEBUG - Created a new instance of MondayAPI.
2025-01-12 19:22:45,595 - app_logger - INFO - Monday Database Utility initialized
2025-01-12 19:22:45,596 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 19:22:45,596 - app_logger - DEBUG - Created a new instance of MondayDatabaseUtil.
2025-01-12 19:22:45,596 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 19:22:45,596 - app_logger - INFO - Monday Service initialized
2025-01-12 19:22:45,596 - app_logger - DEBUG - Created a new instance of MondayService.
2025-01-12 19:22:45,596 - app_logger - INFO - PO Log Database Util initialized
2025-01-12 19:22:45,596 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 19:22:45,596 - app_logger - DEBUG - Created a new instance of PoLogDatabaseUtil.
2025-01-12 19:22:45,597 - app_logger - INFO - üé¨üçø PO Log Processor initialized (Custom Version) üåü
2025-01-12 19:22:45,597 - app_logger - DEBUG - Created a new instance of POLogProcessor.
2025-01-12 19:22:45,623 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 19:22:45,623 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 19:22:45,628 - app_logger - INFO - OCR Service initialized
2025-01-12 19:22:45,628 - app_logger - DEBUG - Created a new instance of OCRService.
2025-01-12 19:22:45,628 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 19:22:45,628 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 19:22:45,629 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 19:22:45,629 - app_logger - DEBUG - Initialized XeroServices.
2025-01-12 19:22:45,629 - app_logger - DEBUG - Created a new instance of XeroServices.
2025-01-12 19:22:45,686 - app_logger - DEBUG - Using existing instance of POLogProcessor.
2025-01-12 19:22:45,686 - app_logger - DEBUG - üåü Hello from DatabaseOperations constructor! Ready to keep the DB in check!
2025-01-12 19:22:45,686 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 19:22:45,686 - app_logger - INFO - üì¶ Dropbox Service initialized üåü
2025-01-12 19:22:45,686 - app_logger - DEBUG - Created a new instance of DropboxService.
2025-01-12 19:22:45,686 - app_logger - INFO - Monday Webhook Handler Initialized
2025-01-12 19:22:45,686 - app_logger - DEBUG - Created a new instance of MondayWebhookHandler.
2025-01-12 19:22:45,686 - app_logger - INFO - Dropbox Webhook Handler  initialized
2025-01-12 19:22:45,686 - app_logger - DEBUG - Created a new instance of DropboxWebhookHandler.
2025-01-12 19:22:45,687 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 19:22:45,701 - app_logger - DEBUG - Database connection string: mysql+pymysql://root:z //55gohi@localhost:3306/virtual_pm
2025-01-12 19:22:45,701 - app_logger - INFO - Database initialized.
2025-01-12 19:22:45,701 - app_logger - DEBUG - Using existing instance of OCRService.
2025-01-12 19:22:45,701 - app_logger - INFO - Orchestrator initialized.
2025-01-12 19:22:45,701 - app_logger - INFO - Starting background tasks...
2025-01-12 19:22:45,701 - app_logger - INFO - Starting Flask server for webhooks...
2025-01-12 19:22:45,758 - app_logger - INFO - Flask server running on port 5002.
2025-01-12 19:22:53,590 - Trigger-logs - DEBUG - Added file handler to app_logger.
2025-01-12 19:22:53,590 - Trigger-logs - DEBUG - Added console handler to app_logger.
2025-01-12 19:22:53,590 - Trigger-logs - DEBUG - [DEBUG] Trigger-logs has 2 handlers attached.
2025-01-12 20:51:10,592 - Trigger-logs - DEBUG - Added file handler to app_logger.
2025-01-12 20:51:10,592 - Trigger-logs - DEBUG - Added console handler to app_logger.
2025-01-12 20:51:10,592 - Trigger-logs - DEBUG - [DEBUG] Trigger-logs has 2 handlers attached.
2025-01-12 22:36:15,398 - app_logger - INFO - Received Dropbox event.
2025-01-12 22:36:15,400 - app_logger - INFO - Starting to process event data...
2025-01-12 22:36:15,401 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 22:36:15,898 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 22:36:15,899 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 22:36:15,900 - app_logger - INFO - Changes (1):
2025-01-12 22:36:15,900 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 22:36:15,900 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 22:36:15,900 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 22:36:15,900 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 22:36:16,630 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 22:36:17,482 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 22:36:17,482 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 22:36:17,851 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 22:36:18,708 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 22:36:18,709 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 22:36:18,728 - app_logger - INFO - ‚úÖ Found exactly 1 matching Invoice.
2025-01-12 22:36:18,728 - app_logger - DEBUG - ü§ì Pulling record: 90 from table invoice
2025-01-12 22:36:18,728 - app_logger - INFO - üîÑ Updating existing invoice #1 for PO 21.
2025-01-12 22:36:18,728 - app_logger - DEBUG - üßæ update_invoice -> Invoice(id=90), data={'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 22:36:18,728 - app_logger - DEBUG - üîß Attempting to update Invoice(id=90). Fields: {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 22:36:18,728 - app_logger - INFO - ü§ù Checking if Invoice(id=90) exists, then updating with {'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}.
2025-01-12 22:36:18,731 - app_logger - DEBUG - ü™Ñ Flushed updated Invoice(id=90).
2025-01-12 22:36:18,731 - app_logger - INFO - ‚úÖ Done updating! The record is all set.
2025-01-12 22:36:18,732 - app_logger - DEBUG - ü§ì Pulling record: 90 from table invoice
2025-01-12 22:36:18,734 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 22:36:18,735 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 22:36:18,747 - app_logger - INFO - Received Dropbox event.
2025-01-12 22:36:18,747 - app_logger - INFO - Starting to process event data...
2025-01-12 22:36:18,747 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 22:36:18,908 - app_logger - DEBUG - Fetched 0 changes.
2025-01-12 22:36:18,909 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 22:36:18,909 - app_logger - INFO - Changes (0):
2025-01-12 22:36:18,910 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 22:37:52,376 - app_logger - INFO - Received Dropbox event.
2025-01-12 22:37:52,376 - app_logger - INFO - Starting to process event data...
2025-01-12 22:37:52,377 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 22:37:52,672 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 22:37:52,673 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 22:37:52,673 - app_logger - DEBUG - DELETE: DeletedMetadata(name='2416_21_01 Jordan Sakai Invoice.pdf', parent_shared_folder_id=NOT_SET, path_display='/2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf', path_lower='/2416 - whop keynote/1. purchase orders/2416_21 jordan sakai/2416_21_01 jordan sakai invoice.pdf', preview_url=NOT_SET)
2025-01-12 22:37:52,673 - app_logger - INFO - Changes (0):
2025-01-12 22:37:52,674 - app_logger - DEBUG - Cursor successfully updated in the finally block.
2025-01-12 22:37:55,797 - app_logger - INFO - Received Dropbox event.
2025-01-12 22:37:55,798 - app_logger - INFO - Starting to process event data...
2025-01-12 22:37:55,799 - app_logger - DEBUG - Fetching changes using the cursor.
2025-01-12 22:37:55,986 - app_logger - DEBUG - Fetched 1 changes.
2025-01-12 22:37:55,987 - app_logger - DEBUG - Cursor saved to prevent duplicate processing.
2025-01-12 22:37:55,987 - app_logger - INFO - Changes (1):
2025-01-12 22:37:55,987 - app_logger - INFO - File Added: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 22:37:55,987 - app_logger - INFO - üîç Checking file type for: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 22:37:55,987 - app_logger - INFO - üí∞ Identified as invoice: 2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 22:37:55,987 - app_logger - INFO - üìÑ Processing invoice: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 22:37:56,608 - app_logger - DEBUG - Shared link already exists, retrieving existing link.
2025-01-12 22:37:57,608 - app_logger - DEBUG - Found existing shared link for /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 22:37:57,609 - app_logger - INFO - üîó Obtained Dropbox link for invoice: https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0
2025-01-12 22:37:58,100 - app_logger - INFO - üîé Scanning invoice file for data with OCRService + OpenAI...
2025-01-12 22:37:58,854 - app_logger - DEBUG - ‚ùì Checking for Invoices with (project_number='2416', po_number='21', invoice_number='1').
2025-01-12 22:37:58,854 - app_logger - INFO - üîé Searching Invoices with project_number='2416', po_number='21', invoice_number='1'
2025-01-12 22:37:58,857 - app_logger - INFO - üôÖ No Invoices matched.
2025-01-12 22:37:58,860 - app_logger - INFO - üÜï Creating new invoice #1 for PO 21 (project 2416).
2025-01-12 22:37:58,860 - app_logger - DEBUG - üßæ create_invoice with {'project_number': 2416, 'po_number': 21, 'invoice_number': 1, 'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 22:37:58,860 - app_logger - DEBUG - üßë‚Äçüíª Creating new Invoice using data: {'project_number': 2416, 'po_number': 21, 'invoice_number': 1, 'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 22:37:58,860 - app_logger - INFO - üå± About to insert a fresh record into Invoice with {'project_number': 2416, 'po_number': 21, 'invoice_number': 1, 'transaction_date': datetime.datetime(2024, 11, 4, 0, 0), 'term': 30, 'total': 5000.0, 'file_link': 'https://www.dropbox.com/scl/fi/ba0u20nsdi13rlfp3bfva/2416_21_01-Jordan-Sakai-Invoice.pdf?rlkey=n5d3x2dkrebu9pngiosgl51v0&dl=0'}
2025-01-12 22:37:58,862 - app_logger - DEBUG - ü™Ñ Flushed new Invoice. ID now: 91
2025-01-12 22:37:58,863 - app_logger - INFO - üéâ Creation successful! Record is now in the DB.
2025-01-12 22:37:58,865 - app_logger - DEBUG - ü§ì Pulling record: 91 from table invoice
2025-01-12 22:37:58,866 - app_logger - INFO - ‚úÖ Minimal invoice processing complete for: /2416 - Whop Keynote/1. Purchase Orders/2416_21 Jordan Sakai/2416_21_01 Jordan Sakai Invoice.pdf
2025-01-12 22:37:58,866 - app_logger - DEBUG - Cursor successfully updated in the finally block.
